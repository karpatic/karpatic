{"meta":{"filename":"09_browser_extensions","title":"Chrome Extension Basics","summary":"Light notes about creating Chrome browser extensions using for V2 Extensions.","toc":"true"},"content":"<p>⚠️ This writing is a work in progress.⚠️</p>\n <div class=\"unset\">\n   <style>\n   .unset{padding:0px;}\n   .unset p a img {\n     width: auto;\n   }\n   .unset p{ margin:10px;}\n   </style> <p><a href=\"https://mybinder.org/v2/gh/bnia/dataguide/main?filepath=%2Fnotebooks%2F09_Browser_Extensions.ipynb\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://mybinder.org/badge_logo.svg\" alt=\"Binder\"></a>\n <a href=\"https://colab.research.google.com/github/bnia/dataguide/blob/main/notebooks/09_Browser_Extensions.ipynb\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://pete88b.github.io/fastpages/assets/badges/colab.svg\" alt=\"Binder\"></a>\n <a href=\"https://github.com/bnia/dataguide/tree/main/notebooks/09_Browser_Extensions.ipynb\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://pete88b.github.io/fastpages/assets/badges/github.svg\" alt=\"Binder\"></a>\n <a href=\"https://github.com/ellerbrock/open-source-badges/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://badges.frapsoft.com/os/v3/open-source.svg?v=103\" alt=\"Open Source Love svg3\"></a></p>\n<p> <a href=\"https://github.com/bnia/dataguide/blob/main/LICENSE\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/npm/l/all-contributors.svg?style=flat\" alt=\"NPM License\"></a>\n <a href=\"https://bnia.github.io\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"http://img.shields.io/badge/Status-Active-green.svg\" alt=\"Active\"></a> \n <a href=\"\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/github/last-commit/bnia/dataguide.svg?style=flat\" alt=\"GitHub last commit\"></a>  </p>\n<p> <a href=\"https://github.com/bnia/dataguide\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/github/stars/bnia/dataguide.svg?style=social&label=Star\" alt=\"GitHub stars\"></a> \n <a href=\"https://github.com/bnia/dataguide\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/github/watchers/bnia/dataguide.svg?style=social&label=Watch\" alt=\"GitHub watchers\"></a> \n <a href=\"https://github.com/bnia/dataguide\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/github/forks/bnia/dataguide.svg?style=social&label=Fork\" alt=\"GitHub forks\"></a> \n <a href=\"https://github.com/bnia/dataguide\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/github/followers/bnia.svg?style=social&label=Follow\" alt=\"GitHub followers\"></a> </p>\n<p> <a href=\"https://twitter.com/intent/tweet?text=Check%20out%20this%20%E2%9C%A8%20colab%20by%20@bniajfi%20https://github.com/bnia/dataguide%20%F0%9F%A4%97\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/twitter/url/https/github.com/bnia/dataguide.svg?style=social\" alt=\"Tweet\"></a> \n <a href=\"https://twitter.com/bniajfi\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"><img src=\"https://img.shields.io/twitter/follow/bniajfi.svg?style=social\" alt=\"Twitter Follow\"></a></p>\n </div> <blockquote>\n<p>note: There is a lot of quoting and paraphrasing on this page in particular. Be sure to check the links you want to learn more.</p>\n</blockquote>\n <blockquote>\n<p>notice: Chrome&#39;s V2 <a href=\"https://developer.chrome.com/docs/extensions/mv2/getstarted/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Documentation</a> on their Extensions were used extensively in the writing of this piece. Refer to the above link for something more complete.</p>\n</blockquote>\n <blockquote>\n<p>warning: A new Chrome Extension <a href=\"https://developer.chrome.com/docs/extensions/mv3/intro/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Versioning</a> exists and so information is effectively now old and may be depricated. </p>\n</blockquote>\n <p><a href=\"https://developer.chrome.com/docs/extensions/mv2/overview/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Extensions</a> are browser-event based programs that enhance the Chrome browsing experience. </p>\n<p> <a href=\"https://developer.chrome.com/docs/extensions/reference/browserAction/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">browserAction</a>/ <a href=\"https://developer.chrome.com/docs/extensions/mv3/user_interface/#popup\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Popup</a> - What we all think of when we think of an extension. A small box in the corner that opens a popup when clicked.</p>\n<p> <a href=\"https://developer.chrome.com/docs/extensions/mv3/background_pages/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Background</a> scripts - No User interface. Do not execute on the bhe webpage. Can be triggered by an event.</p>\n<p> <a href=\"https://developer.chrome.com/docs/extensions/mv3/content_scripts/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">content</a> scripts - Can modify a webpage. runs inline on the browser.</p>\n<p> <a href=\"https://riptutorial.com/google-chrome-extension/example/13137/options-page\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">options</a> page - A dedicated page a developer can create that lets users set up options for the extension. </p>\n<p> <a href=\"https://developer.chrome.com/docs/extensions/mv2/themes/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">themes</a> - Change the look of the browser</p>\n <p> Extensions are made of different, but cohesive, components:</p>\n<ol>\n<li><p>Create the manifest.json</p></li>\n<li><p>Add instruction</p></li>\n<li><p>Introduce a user interface</p></li>\n<li><p>Layer logic</p></li>\n<li><p>Give users options</p></li>\n<li><p>Take the next step</p></li>\n</ol>\n <p><a href=\"https://github.com/GoogleChrome/chrome-extensions-samples\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Examples</a></p>\n <h2 id=\"create-the-manifestjson\">Create the manifest.json</h2>\n <p>The directory holding the manifest file can be added as an extension in developer mode in its current state.</p>\n<pre><code>{\n  &quot;name&quot;: &quot;Getting Started Example&quot;,\n  &quot;version&quot;: &quot;1.0&quot;,\n  &quot;description&quot;: &quot;Build an Extension!&quot;,\n  &quot;manifest_version&quot;: 2\n}\n</code></pre>\n<p> chrome://extensions =&gt; More Tools =&gt; Extensions =&gt; Enable Developer Mode then click LOAD UNPACKED</p>\n <h2 id=\"add-instruction\">Add instruction</h2>\n <blockquote>\n<p>A background page is loaded when it is needed, and unloaded when it goes idle. Some examples of events include:</p>\n<ul>\n<li><p>The extension is first installed or updated to a new version.</p></li>\n<li><p>The background page was listening for an event, and the event is dispatched.</p></li>\n<li><p>A content script or other extension sends a message.</p></li>\n<li><p>Another view in the extension, such as a popup, calls runtime.getBackgroundPage.</p></li>\n</ul>\n</blockquote>\n <p>Although the extension has been installed, it has no instruction. </p>\n<p> Introduce a <a href=\"https://developer.chrome.com/docs/extensions/mv2/background_pages/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">background script</a> by creating a file titled background.js for <a href=\"https://developer.chrome.com/docs/extensions/reference/storage/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">storing</a> data</p>\n<pre><code>chrome.runtime.onInstalled.addListener(function() {\n  chrome.storage.sync.set({color: &#39;#3aa757&#39;}, function() {\n    console.log(&quot;The color is green.&quot;);\n  });\n});\n</code></pre>\n<pre><code>{\n  &quot;name&quot;: &quot;Getting Started Example&quot;,\n  &quot;version&quot;: &quot;1.0&quot;,\n  &quot;description&quot;: &quot;Build an Extension!&quot;,\n  &quot;permissions&quot;: [&quot;storage&quot;],\n  &quot;background&quot;: {\n    &quot;scripts&quot;: [&quot;background.js&quot;],\n    &quot;persistent&quot;: false\n  },\n  &quot;manifest_version&quot;: 2\n}\n</code></pre>\n <h2 id=\"manifest\">Manifest</h2>\n <p><strong>manifest.json</strong>\n This is the only file that must be present in every extension. </p>\n<ul>\n<li><p>It contains basic metadata such as its name, version and the permissions it requires. </p></li>\n<li><p>It also provides pointers to other files in the extension.</p></li>\n</ul>\n<p> This <strong>manifest</strong> can also <em>contain pointers to several</em> other types of files:</p>\n<ul>\n<li><p>Background scripts: Implement long-running logic.</p></li>\n<li><p>Icons for the extension and any buttons it might define.</p></li>\n<li><p>Sidebars, <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Popups\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">popups</a>, and options pages: HTML documents that provide content for various user interface components.</p></li>\n<li><p><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Content scripts</a>: JavaScript included that will be injected into web pages.</p></li>\n<li><p><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Web-accessible resources</a>: Make (images, HTML, CSS, or JavaScript) accessible to pages and content scripts.</p></li>\n</ul>\n <pre><code> manifest.json\n \n {\n     &quot;manifest_version&quot;: 2,\n   \n     &quot;name&quot;: &quot;ACS Downloader&quot;,\n     &quot;description&quot;: &quot;This extension will download ACS data&quot;,\n     &quot;version&quot;: &quot;1.0&quot;,\n   \n     &quot;browser_action&quot;: {\n      &quot;default_title&quot;: &quot;ACS Downloader&quot;,\n      &quot;default_icon&quot;: &quot;icon.png&quot;,\n      &quot;default_popup&quot;: &quot;popup.html&quot;\n     },\n     &quot;permissions&quot;: [\n      &quot;activeTab&quot;\n      ]\n }\n</code></pre>\n <h2 id=\"introduce-a-user-interface\">Introduce a user interface</h2>\n <p>Extensions can have many forms of a user interface, but this one will use a <a href=\"https://developer.chrome.com/docs/extensions/mv2/user_interface/#popup\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">popup</a>. Create a popup.html.</p>\n<p> Like the background script, this file needs to be listed in the manifest under <a href=\"https://developer.chrome.com/docs/extensions/reference/pageAction/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">page_action</a>. </p>\n<p> Toolbar icons are also included under <code>page_action</code> section via the <code>default_icons</code> field. </p>\n<pre><code>{\n  &quot;name&quot;: &quot;Getting Started Example&quot;,\n  &quot;version&quot;: &quot;1.0&quot;,\n  &quot;description&quot;: &quot;Build an Extension!&quot;,\n  &quot;permissions&quot;: [&quot;storage&quot;],\n  &quot;background&quot;: {\n    &quot;scripts&quot;: [&quot;background.js&quot;],\n    &quot;persistent&quot;: false\n  },\n  &quot;page_action&quot;: {\n    &quot;default_popup&quot;: &quot;popup.html&quot;,\n    &quot;default_icon&quot;: {\n      &quot;16&quot;: &quot;images/get_started16.png&quot;,\n      &quot;32&quot;: &quot;images/get_started32.png&quot;,\n      &quot;48&quot;: &quot;images/get_started48.png&quot;,\n      &quot;128&quot;: &quot;images/get_started128.png&quot;\n    }\n  },\n  &quot;icons&quot;: {\n    &quot;16&quot;: &quot;images/get_started16.png&quot;,\n    &quot;32&quot;: &quot;images/get_started32.png&quot;,\n    &quot;48&quot;: &quot;images/get_started48.png&quot;,\n    &quot;128&quot;: &quot;images/get_started128.png&quot;\n  },\n  &quot;manifest_version&quot;: 2\n}\n</code></pre>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;style&gt;\n      button {\n        height: 30px;\n        width: 30px;\n        outline: none;\n      }\n    &lt;/style&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;button id=&quot;changeColor&quot;&gt;&lt;/button&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n <p>Available <a href=\"https://developer.chrome.com/docs/extensions/reference/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">APIS</a></p>\n<ul>\n<li><p><strong>alarms</strong> - Use the chrome.alarms API to schedule code to run periodically or at a specified time in the future.</p></li>\n<li><p><strong>browserAction</strong> -\tUse browser actions to put icons in the main Google Chrome toolbar, to the right of the address bar. In addition to its icon, a browser action can have a tooltip, a badge, and a popup.</p></li>\n<li><p><strong>contextMenus</strong> - Use the chrome.contextMenus API to add items to Google Chrome&#39;s context menu. You can choose what types of objects your context menu additions apply to, such as images, hyperlinks, and pages.</p></li>\n<li><p><strong>desktopCapture</strong> - Desktop Capture API that can be used to capture content of screen, individual windows or tabs.</p></li>\n<li><p><strong>devtools.inspectedWindow</strong> - Use the chrome.devtools.inspectedWindow API to interact with the inspected window: obtain the tab ID for the inspected page, evaluate the code in the context of the inspected window, reload the page, or obtain the list of resources within the page.</p></li>\n<li><p><strong>devtools.network</strong> - Use the chrome.devtools.network API to retrieve the information about network requests displayed by the Developer Tools in the Network panel.</p></li>\n<li><p><strong>devtools.panels</strong> - Use the chrome.devtools.panels API to integrate your extension into Developer Tools window UI: create your own panels, access existing panels, and add sidebars.</p></li>\n<li><p><strong>events</strong> - The chrome.events namespace contains common types used by APIs dispatching events to notify you when something interesting happens.</p></li>\n<li><p><strong>fileSystemProvider</strong> - Use the chrome.fileSystemProvider API to create file systems, that can be accessible from the file manager on Chrome OS.</p></li>\n<li><p><strong>fontSettings</strong> - Use the chrome.fontSettings API to manage Chrome&#39;s font settings.</p></li>\n<li><p><strong>notifications</strong> - Use the chrome.notifications API to create rich notifications using templates and show these notifications to users in the system tray.</p></li>\n<li><p><strong>pageAction</strong> - Use the chrome.pageAction API to put icons in the main Google Chrome toolbar, to the right of the address bar. Page actions represent actions that can be taken on the current page, but that aren&#39;t applicable to all pages. Page actions appear grayed out when inactive.</p></li>\n<li><p><strong>pageCapture</strong>\t- Use the chrome.pageCapture API to save a tab as MHTML.</p></li>\n<li><p><strong>permissions</strong>\t- Use the chrome.permissions API to request declared optional permissions at run time rather than install time, so users understand why the permissions are needed and grant only those that are necessary.</p></li>\n<li><p><strong>tts</strong>\t- Use the chrome.tts API to play synthesized text-to-speech (TTS). See also the related ttsEngine API, which allows an extension to implement a speech engine.</p></li>\n<li><p>webRequest - Use the chrome.webRequest API to observe and analyze traffic and to intercept, block, or modify requests in-flight.</p></li>\n<li><p><strong>automation</strong> - The chrome.automation API allows developers to access the automation (accessibility) tree for the browser. The tree resembles the DOM tree, but only exposes the semantic structure of a page. It can be used to programmatically interact with a page by examining names, roles, and states, listening for events, and performing actions on nodes.</p></li>\n<li><p><strong>processes</strong>\t- Use the chrome.processes API to interact with the browser&#39;s processes.</p></li>\n</ul>\n <h2 id=\"content-scripts\"><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Content scripts</a></h2>\n <p>A <strong>content script</strong> is a part of your extension that* runs in the context of a particular web page* </p>\n<p> (as opposed to <strong><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#Background_scripts\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">background</a> scripts</strong> which are <em>part of the extension</em>, </p>\n<p> or <strong>scripts</strong> which are <em>part of the web site itself</em></p>\n <pre><code> popup.html\n \n &lt;!doctype html&gt;\n &lt;html&gt;\n   &lt;head&gt;\n     &lt;title&gt;ACS Downloader&lt;/title&gt;\n     &lt;style&gt;\n       body {\n         min-width: 357px;\n         overflow-x: hidden;\n       }\n \n       img {\n         margin: 5px;\n         border: 2px solid black;\n         vertical-align: middle;\n         width: 75px;\n         height: 75px;\n       }\n     &lt;/style&gt;\n     &lt;!--\n       - JavaScript and HTML must be in separate files: see our Content Security\n       - Policy documentation[1] for details and explanation.\n       - [1]: http://developer.chrome.com/extensions/contentSecurityPolicy.html\n      --&gt;\n     &lt;script src=&quot;popup.js&quot;&gt;&lt;/script&gt;\n   &lt;/head&gt;\n   &lt;body&gt;\n       &lt;h1&gt;ACS Downloader&lt;/h1&gt;\n   &lt;/body&gt;\n &lt;/html&gt;\n</code></pre>\n <blockquote>\n<p>Background scripts can access all the WebExtension JavaScript APIs, but they can&#39;t directly access the content of web pages. So if your extension needs to do that, you need content scripts.</p>\n</blockquote>\n <h2 id=\"load-the-extension\"><a href=\"https://www.adambarth.com/experimental/crx/docs/getstarted.html\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Load</a> the extension.</h2>\n <ul>\n<li><p>Bring up the extensions management page by clicking the wrench icon  and choosing Tools &gt; Extensions.</p>\n</li>\n<li><p>If the label &quot;Developer mode&quot; has a + button by it, click it. More buttons and information appear.</p>\n</li>\n<li><p>Click the Load unpacked extension button. A file dialog appears.</p>\n</li>\n<li><p>In the file dialog, navigate to your extension&#39;s folder and click OK.</p>\n</li>\n<li><p>If your extension is valid, its icon appears next to the address bar, and information about the extension appears in the extensions page, as the following screenshot shows. Otherwise, an Error button that reveals a popup help you out.</p>\n</li>\n<li><p>Finally, Click vertical ellipsis (in the top right of the broswer) &gt; Hover over &quot;More tools&quot; &gt; Select &quot;<a href=\"chrome://extensions/\" onclick=\"window.sendPing(this)\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Extensions</a>&quot; (or just click that link)</p>\n</li>\n</ul>\n"}