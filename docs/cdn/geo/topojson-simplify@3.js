!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("topojson-client")):"function"==typeof define&&define.amd?define(["exports","topojson-client"],n):n((r=r||self).topojson=r.topojson||{},r.topojson)}(this,(function(r,n){"use strict";function e(){return!0}function t(r){return r}function o(r){return null!=r.type}function a(r){var n,d=new Array(r.arcs.length),M=0;function o(r){switch(r.type){case"GeometryCollection":r.geometries.forEach(o);break;case"Polygon":a(r.arcs);break;case"MultiPolygon":r.arcs.forEach(a)}}function a(r){for(var n=0,j=r.length;n<j;++n,++M)for(var k=r[n],P=0,A=k.length;P<A;++P){var _=k[P];_<0&&(_=~_);var E=d[_];null==E?d[_]=M:E!==M&&(d[_]=-1)}}for(n in r.objects)o(r.objects[n]);return function(r){for(var n,M=0,j=r.length;M<j;++M)if(-1===d[(n=r[M])<0?~n:n])return!0;return!1}}function i(r){var n=r[0],d=r[1],M=r[2];return Math.abs((n[0]-M[0])*(d[1]-n[1])-(n[0]-d[0])*(M[1]-n[1]))/2}function c(r){for(var n,d=-1,M=r.length,j=r[M-1],k=0;++d<M;)n=j,j=r[d],k+=n[0]*j[1]-n[1]*j[0];return Math.abs(k)/2}function u(r,d,M){return d=null==d?Number.MIN_VALUE:+d,null==M&&(M=c),function(j,k){return M(n.feature(r,{type:"Polygon",arcs:[j]}).geometry.coordinates[0],k)>=d}}function f(r,n){return r[1][2]-n[1][2]}function l(r){return[r[0],r[1],0]}function s(r,n){return n-r}var d=Math.PI,M=2*d,j=d/4,k=d/180,P=Math.abs,A=Math.atan2,_=Math.cos,E=Math.sin;function x(r,n){for(var d,M,P=0,w=r.length,L=0,C=r[n?P++:w-1],G=C[0]*k,S=C[1]*k/2+j,T=_(S),N=E(S);P<w;++P){d=G,G=(C=r[P])[0]*k,S=C[1]*k/2+j,M=T,T=_(S);var I=G-d,q=I>=0?1:-1,R=q*I,U=N*(N=E(S)),V=M*T+U*_(R),W=U*q*E(R);L+=A(W,V)}return L}r.filter=function(r,n){var d,M=r.objects,j={};function u(r){var n,d;switch(r.type){case"Polygon":n=(d=f(r.arcs))?{type:"Polygon",arcs:d}:{type:null};break;case"MultiPolygon":n=(d=r.arcs.map(f).filter(t)).length?{type:"MultiPolygon",arcs:d}:{type:null};break;case"GeometryCollection":n=(d=r.geometries.map(u).filter(o)).length?{type:"GeometryCollection",geometries:d}:{type:null};break;default:return r}return null!=r.id&&(n.id=r.id),null!=r.bbox&&(n.bbox=r.bbox),null!=r.properties&&(n.properties=r.properties),n}function f(r){return r.length&&(d=r[0],n(d,!1))?[r[0]].concat(r.slice(1).filter(l)):null;var d}function l(r){return n(r,!0)}for(d in null==n&&(n=e),M)j[d]=u(M[d]);return function(r){var n,d,M=r.objects,j={},k=r.arcs,P=k.length,A=-1,_=new Array(P),E=0,w=-1;function s(r){switch(r.type){case"GeometryCollection":r.geometries.forEach(s);break;case"LineString":b(r.arcs);break;case"MultiLineString":case"Polygon":r.arcs.forEach(b);break;case"MultiPolygon":r.arcs.forEach(y)}}function p(r){r<0&&(r=~r),_[r]||(_[r]=1,++E)}function b(r){r.forEach(p)}function y(r){r.forEach(b)}function g(r){var n;switch(r.type){case"GeometryCollection":n={type:"GeometryCollection",geometries:r.geometries.map(g)};break;case"LineString":n={type:"LineString",arcs:m(r.arcs)};break;case"MultiLineString":n={type:"MultiLineString",arcs:r.arcs.map(m)};break;case"Polygon":n={type:"Polygon",arcs:r.arcs.map(m)};break;case"MultiPolygon":n={type:"MultiPolygon",arcs:r.arcs.map(v)};break;default:return r}return null!=r.id&&(n.id=r.id),null!=r.bbox&&(n.bbox=r.bbox),null!=r.properties&&(n.properties=r.properties),n}function h(r){return r<0?~_[~r]:_[r]}function m(r){return r.map(h)}function v(r){return r.map(m)}for(d in M)s(M[d]);for(n=new Array(E);++A<P;)_[A]&&(_[A]=++w,n[w]=k[A]);for(d in M)j[d]=g(M[d]);return{type:"Topology",bbox:r.bbox,transform:r.transform,objects:j,arcs:n}}({type:"Topology",bbox:r.bbox,transform:r.transform,objects:j,arcs:r.arcs})},r.filterAttached=a,r.filterAttachedWeight=function(r,n,d){var M=a(r),j=u(r,n,d);return function(r,n){return M(r,n)||j(r,n)}},r.filterWeight=u,r.planarRingArea=c,r.planarTriangleArea=i,r.presimplify=function(r,d){var M=r.transform?n.transform(r.transform):l,j=function(){var r={},n=[],d=0;function t(r,d){for(;d>0;){var M=(d+1>>1)-1,j=n[M];if(f(r,j)>=0)break;n[j._=d]=j,n[r._=d=M]=r}}function o(r,M){for(;;){var j=M+1<<1,k=j-1,P=M,A=n[P];if(k<d&&f(n[k],A)<0&&(A=n[P=k]),j<d&&f(n[j],A)<0&&(A=n[P=j]),P===M)break;n[A._=M]=A,n[r._=M=P]=r}}return r.push=function(r){return t(n[r._=d]=r,d++),d},r.pop=function(){if(!(d<=0)){var r,M=n[0];return--d>0&&(r=n[d],o(n[r._=0]=r,0)),M}},r.remove=function(r){var M,j=r._;if(n[j]===r)return j!==--d&&(f(M=n[d],r)<0?t:o)(n[M._=j]=M,j),j},r}();null==d&&(d=i);var k=r.arcs.map((function(r){var n,k,P,A=[],_=0;for(k=1,P=(r=r.map(M)).length-1;k<P;++k)(n=[r[k-1],r[k],r[k+1]])[1][2]=d(n),A.push(n),j.push(n);for(r[0][2]=r[P][2]=1/0,k=0,P=A.length;k<P;++k)(n=A[k]).previous=A[k-1],n.next=A[k+1];for(;n=j.pop();){var E=n.previous,w=n.next;n[1][2]<_?n[1][2]=_:_=n[1][2],E&&(E.next=w,E[2]=n[2],c(E)),w&&(w.previous=E,w[0]=n[0],c(w))}return r}));function c(r){j.remove(r),r[1][2]=d(r),j.push(r)}return{type:"Topology",bbox:r.bbox,objects:r.objects,arcs:k}},r.quantile=function(r,n){var d=[];return r.arcs.forEach((function(r){r.forEach((function(r){isFinite(r[2])&&d.push(r[2])}))})),d.length&&function(r,n){if(d=r.length){if((n=+n)<=0||d<2)return r[0];if(n>=1)return r[d-1];var d,M=(d-1)*n,j=Math.floor(M),k=r[j];return k+(r[j+1]-k)*(M-j)}}(d.sort(s),n)},r.simplify=function(r,n){n=null==n?Number.MIN_VALUE:+n;var d=r.arcs.map((function(r){for(var d,M=-1,j=0,k=r.length,P=new Array(k);++M<k;)(d=r[M])[2]>=n&&(P[j++]=[d[0],d[1]]);return P.length=j,P}));return{type:"Topology",transform:r.transform,bbox:r.bbox,objects:r.objects,arcs:d}},r.sphericalRingArea=function(r,n){var d=x(r,!0);return n&&(d*=-1),2*(d<0?M+d:d)},r.sphericalTriangleArea=function(r){return 2*P(x(r,!1))},Object.defineProperty(r,"__esModule",{value:!0})}));