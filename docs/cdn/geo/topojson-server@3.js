var r,n;r=this,n=function(o){"use strict";var i=Object.prototype.hasOwnProperty;function t(o,i,x,w,L,S){3===arguments.length&&(w=S=Array,L=null);for(var C=new w(o=1<<Math.max(4,Math.ceil(Math.log(o)/Math.LN2))),j=new S(o),G=o-1,I=0;I<o;++I)C[I]=L;return{set:function(w,S){for(var I=i(w)&G,k=C[I],F=0;k!=L;){if(x(k,w))return j[I]=S;if(++F>=o)throw new Error("full hashmap");k=C[I=I+1&G]}return C[I]=w,j[I]=S,S},maybeSet:function(w,S){for(var I=i(w)&G,k=C[I],F=0;k!=L;){if(x(k,w))return j[I];if(++F>=o)throw new Error("full hashmap");k=C[I=I+1&G]}return C[I]=w,j[I]=S,S},get:function(w,S){for(var I=i(w)&G,k=C[I],F=0;k!=L;){if(x(k,w))return j[I];if(++F>=o)break;k=C[I=I+1&G]}return S},keys:function(){for(var o=[],i=0,x=C.length;i<x;++i){var w=C[i];w!=L&&o.push(w)}return o}}}function e(o,i){return o[0]===i[0]&&o[1]===i[1]}var x=new ArrayBuffer(16),w=new Float64Array(x),L=new Uint32Array(x);function u(o){w[0]=o[0],w[1]=o[1];var i=L[0]^L[1];return 2147483647&(i<<5^i>>7^L[2]^L[3])}function f(o){var i,x,w,L,S=o.coordinates,C=o.lines,j=o.rings,G=function(){for(var o=t(1.4*S.length,A,E,Int32Array,-1,Int32Array),i=new Int32Array(S.length),x=0,w=S.length;x<w;++x)i[x]=o.maybeSet(x,x);return i}(),I=new Int32Array(S.length),k=new Int32Array(S.length),F=new Int32Array(S.length),O=new Int8Array(S.length),N=0;for(i=0,x=S.length;i<x;++i)I[i]=k[i]=F[i]=-1;for(i=0,x=C.length;i<x;++i){var _=C[i],B=_[0],T=_[1];for(w=G[B],L=G[++B],++N,O[w]=1;++B<=T;)P(i,w,w=L,L=G[B]);++N,O[L]=1}for(i=0,x=S.length;i<x;++i)I[i]=-1;for(i=0,x=j.length;i<x;++i){var U=j[i],q=U[0]+1,z=U[1];for(P(i,G[z-1],w=G[q-1],L=G[q]);++q<=z;)P(i,w,w=L,L=G[q])}function P(o,i,x,w){if(I[x]!==o){I[x]=o;var L=k[x];if(L>=0){var S=F[x];L===i&&S===w||L===w&&S===i||(++N,O[x]=1)}else k[x]=i,F[x]=w}}function A(o){return u(S[o])}function E(o,i){return e(S[o],S[i])}I=k=F=null;var D,H=function(o,i,x,w,L){3===arguments.length&&(w=Array,L=null);for(var S=new w(o=1<<Math.max(4,Math.ceil(Math.log(o)/Math.LN2))),C=o-1,j=0;j<o;++j)S[j]=L;return{add:function(w){for(var j=i(w)&C,G=S[j],I=0;G!=L;){if(x(G,w))return!0;if(++I>=o)throw new Error("full hashset");G=S[j=j+1&C]}return S[j]=w,!0},has:function(w){for(var j=i(w)&C,G=S[j],I=0;G!=L;){if(x(G,w))return!0;if(++I>=o)break;G=S[j=j+1&C]}return!1},values:function(){for(var o=[],i=0,x=S.length;i<x;++i){var w=S[i];w!=L&&o.push(w)}return o}}}(1.4*N,u,e);for(i=0,x=S.length;i<x;++i)O[D=G[i]]&&H.add(S[D]);return H}function c(o,i,x){for(var w,L=i+(x---i>>1);i<L;++i,--x)w=o[i],o[i]=o[x],o[x]=w}function l(o){var i,x=s(o.geometry);for(i in null!=o.id&&(x.id=o.id),null!=o.bbox&&(x.bbox=o.bbox),o.properties){x.properties=o.properties;break}return x}function s(o){if(null==o)return{type:null};var i="GeometryCollection"===o.type?{type:"GeometryCollection",geometries:o.geometries.map(s)}:"Point"===o.type||"MultiPoint"===o.type?{type:o.type,coordinates:o.coordinates}:{type:o.type,arcs:o.coordinates};return null!=o.bbox&&(i.bbox=o.bbox),i}function h(o){var i,x=o[0],w=o[1];return w<x&&(i=x,x=w,w=i),x+31*w}function g(o,i){var x,w=o[0],L=o[1],S=i[0],C=i[1];return L<w&&(x=w,w=L,L=x),C<S&&(x=S,S=C,C=x),w===S&&L===C}o.topology=function(o,x){var w=function(o){var x=1/0,w=1/0,L=-1/0,S=-1/0;function a(o){null!=o&&i.call(C,o.type)&&C[o.type](o)}var C={GeometryCollection:function(o){o.geometries.forEach(a)},Point:function(o){f(o.coordinates)},MultiPoint:function(o){o.coordinates.forEach(f)},LineString:function(o){c(o.arcs)},MultiLineString:function(o){o.arcs.forEach(c)},Polygon:function(o){o.arcs.forEach(c)},MultiPolygon:function(o){o.arcs.forEach(l)}};function f(o){var i=o[0],C=o[1];i<x&&(x=i),i>L&&(L=i),C<w&&(w=C),C>S&&(S=C)}function c(o){o.forEach(f)}function l(o){o.forEach(c)}for(var j in o)a(o[j]);return L>=x&&S>=w?[x,w,L,S]:void 0}(o=function(o){var i,x,w={};for(i in o)w[i]=null==(x=o[i])?{type:null}:("FeatureCollection"===x.type?function(o){var i={type:"GeometryCollection",geometries:o.features.map(l)};return null!=o.bbox&&(i.bbox=o.bbox),i}:"Feature"===x.type?l:s)(x);return w}(o)),L=x>0&&w&&function(o,x,w){var L=x[0],S=x[1],C=x[2],j=x[3],G=C-L?(w-1)/(C-L):1,I=j-S?(w-1)/(j-S):1;function l(o){return[Math.round((o[0]-L)*G),Math.round((o[1]-S)*I)]}function s(o,i){for(var x,w,C,j,k,F=-1,O=0,N=o.length,_=new Array(N);++F<N;)x=o[F],j=Math.round((x[0]-L)*G),k=Math.round((x[1]-S)*I),j===w&&k===C||(_[O++]=[w=j,C=k]);for(_.length=O;O<i;)O=_.push([_[0][0],_[0][1]]);return _}function h(o){return s(o,2)}function g(o){return s(o,4)}function v(o){return o.map(g)}function p(o){null!=o&&i.call(k,o.type)&&k[o.type](o)}var k={GeometryCollection:function(o){o.geometries.forEach(p)},Point:function(o){o.coordinates=l(o.coordinates)},MultiPoint:function(o){o.coordinates=o.coordinates.map(l)},LineString:function(o){o.arcs=h(o.arcs)},MultiLineString:function(o){o.arcs=o.arcs.map(h)},Polygon:function(o){o.arcs=v(o.arcs)},MultiPolygon:function(o){o.arcs=o.arcs.map(v)}};for(var F in o)p(o[F]);return{scale:[1/G,1/I],translate:[L,S]}}(o,w,x),S=function(o){var i,x,w,L,S=o.coordinates,C=o.lines,j=o.rings,G=C.length+j.length;for(delete o.lines,delete o.rings,w=0,L=C.length;w<L;++w)for(i=C[w];i=i.next;)++G;for(w=0,L=j.length;w<L;++w)for(x=j[w];x=x.next;)++G;var I=t(2*G*1.4,u,e),k=o.arcs=[];for(w=0,L=C.length;w<L;++w){i=C[w];do{v(i)}while(i=i.next)}for(w=0,L=j.length;w<L;++w)if((x=j[w]).next)do{v(x)}while(x=x.next);else p(x);function v(o){var i,x,w,L,C,j,G,F;if(w=I.get(i=S[o[0]]))for(G=0,F=w.length;G<F;++G)if(y(L=w[G],o))return o[0]=L[0],void(o[1]=L[1]);if(C=I.get(x=S[o[1]]))for(G=0,F=C.length;G<F;++G)if(d(j=C[G],o))return o[1]=j[0],void(o[0]=j[1]);w?w.push(o):I.set(i,[o]),C?C.push(o):I.set(x,[o]),k.push(o)}function p(o){var i,x,w,L,C;if(x=I.get(S[o[0]]))for(L=0,C=x.length;L<C;++L){if(m(w=x[L],o))return o[0]=w[0],void(o[1]=w[1]);if(b(w,o))return o[0]=w[1],void(o[1]=w[0])}if(x=I.get(i=S[o[0]+M(o)]))for(L=0,C=x.length;L<C;++L){if(m(w=x[L],o))return o[0]=w[0],void(o[1]=w[1]);if(b(w,o))return o[0]=w[1],void(o[1]=w[0])}x?x.push(o):I.set(i,[o]),k.push(o)}function y(o,i){var x=o[0],w=i[0],L=o[1];if(x-L!=w-i[1])return!1;for(;x<=L;++x,++w)if(!e(S[x],S[w]))return!1;return!0}function d(o,i){var x=o[0],w=i[0],L=o[1],C=i[1];if(x-L!=w-C)return!1;for(;x<=L;++x,--C)if(!e(S[x],S[C]))return!1;return!0}function m(o,i){var x=o[0],w=i[0],L=o[1]-x;if(L!==i[1]-w)return!1;for(var C=M(o),j=M(i),G=0;G<L;++G)if(!e(S[x+(G+C)%L],S[w+(G+j)%L]))return!1;return!0}function b(o,i){var x=o[0],w=i[0],L=o[1],C=i[1],j=L-x;if(j!==C-w)return!1;for(var G=M(o),I=j-M(i),k=0;k<j;++k)if(!e(S[x+(k+G)%j],S[C-(k+I)%j]))return!1;return!0}function M(o){for(var i=o[0],x=o[1],w=i,L=w,C=S[w];++w<x;){var j=S[w];(j[0]<C[0]||j[0]===C[0]&&j[1]<C[1])&&(L=w,C=j)}return L-i}return o}(function(o){var i,x,w,L,S,C,j,G=f(o),I=o.coordinates,k=o.lines,F=o.rings;for(x=0,w=k.length;x<w;++x)for(var O=k[x],N=O[0],_=O[1];++N<_;)G.has(I[N])&&(i={0:N,1:O[1]},O[1]=N,O=O.next=i);for(x=0,w=F.length;x<w;++x)for(var B=F[x],T=B[0],U=T,q=B[1],z=G.has(I[T]);++U<q;)G.has(I[U])&&(z?(i={0:U,1:B[1]},B[1]=U,B=B.next=i):(j=q-U,c(L=I,S=T,C=q),c(L,S,S+j),c(L,S+j,C),I[q]=I[T],z=!0,U=T));return o}(function(o){var x=-1,w=[],L=[],S=[];function a(o){o&&i.call(C,o.type)&&C[o.type](o)}var C={GeometryCollection:function(o){o.geometries.forEach(a)},LineString:function(o){o.arcs=f(o.arcs)},MultiLineString:function(o){o.arcs=o.arcs.map(f)},Polygon:function(o){o.arcs=o.arcs.map(c)},MultiPolygon:function(o){o.arcs=o.arcs.map(l)}};function f(o){for(var i=0,L=o.length;i<L;++i)S[++x]=o[i];var C={0:x-L+1,1:x};return w.push(C),C}function c(o){for(var i=0,w=o.length;i<w;++i)S[++x]=o[i];var C={0:x-w+1,1:x};return L.push(C),C}function l(o){return o.map(c)}for(var j in o)a(o[j]);return{type:"Topology",coordinates:S,lines:w,rings:L,objects:o}}(o))),C=S.coordinates,j=t(1.4*S.arcs.length,h,g);function d(o){o&&i.call(G,o.type)&&G[o.type](o)}o=S.objects,S.bbox=w,S.arcs=S.arcs.map((function(o,i){return j.set(o,i),C.slice(o[0],o[1]+1)})),delete S.coordinates,C=null;var G={GeometryCollection:function(o){o.geometries.forEach(d)},LineString:function(o){o.arcs=b(o.arcs)},MultiLineString:function(o){o.arcs=o.arcs.map(b)},Polygon:function(o){o.arcs=o.arcs.map(b)},MultiPolygon:function(o){o.arcs=o.arcs.map(M)}};function b(o){var i=[];do{var x=j.get(o);i.push(o[0]<o[1]?x:~x)}while(o=o.next);return i}function M(o){return o.map(b)}for(var I in o)d(o[I]);return L&&(S.transform=L,S.arcs=function(o){for(var i=-1,x=o.length;++i<x;){for(var w,L,S=o[i],C=0,j=1,G=S.length,I=S[0],k=I[0],F=I[1];++C<G;)w=(I=S[C])[0],L=I[1],w===k&&L===F||(S[j++]=[w-k,L-F],k=w,F=L);1===j&&(S[j++]=[0,0]),S.length=j}return o}(S.arcs)),S},Object.defineProperty(o,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r=r||self).topojson=r.topojson||{});