OpenJsCad=function(){},OpenJsCad.log=function(e){var t=Date.now(),n=OpenJsCad.log.prevLogTime;n||(n=t);var i=t-n;if(OpenJsCad.log.prevLogTime=t,e="["+(.001*i).toFixed(3)+"] "+e,"object"==typeof console&&"function"==typeof console.log);else{if("object"!=typeof self||"function"!=typeof self.postMessage)throw new Error("Cannot log");self.postMessage({cmd:"log",txt:e})}},OpenJsCad.Viewer=function(e,t,n,i){var r=GL.create();this.gl=r,this.angleX=-60,this.angleY=0,this.angleZ=-45,this.viewpointX=0,this.viewpointY=0,this.viewpointZ=i,this.drawAxes=!0,this.drawLines=!1,this.lineOverlay=!1,r.canvas.width=t,r.canvas.height=n,r.viewport(0,0,t,n),r.matrixMode(r.PROJECTION),r.loadIdentity(),r.perspective(45,t/n,.5,1e3),r.matrixMode(r.MODELVIEW),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.clearColor(.93,.93,.93,1),r.enable(r.DEPTH_TEST),r.enable(r.CULL_FACE),r.polygonOffset(1,1),this.blackShader=new GL.Shader("    void main() {      gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;    }  ","    void main() {      gl_FragColor = vec4(0.0, 0.0, 0.0, 0.1);    }  "),this.lightingShader=new GL.Shader("    varying vec3 color;    varying vec3 normal;    varying vec3 light;    void main() {      const vec3 lightDir = vec3(1.0, 2.0, 3.0) / 3.741657386773941;      light = lightDir;      color = gl_Color.rgb;      normal = gl_NormalMatrix * gl_Normal;      gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;    }  ","    varying vec3 color;    varying vec3 normal;    varying vec3 light;    void main() {      vec3 n = normalize(normal);      float diffuse = max(0.0, dot(light, n));      float specular = pow(max(0.0, -reflect(light, n).z), 10.0) * sqrt(diffuse);      gl_FragColor = vec4(mix(color * (0.3 + 0.7 * diffuse), vec3(1.0), specular), 1.0);    }  "),e.appendChild(r.canvas);var o=this;r.onmousemove=function(e){o.onMouseMove(e)},r.ondraw=function(){o.onDraw()},r.onmousewheel=function(e){var t=0;if(e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-40*e.detail),t){var n=Math.pow(1.003,-t),i=o.getZoom();i*=n,o.setZoom(i)}},this.clear()},OpenJsCad.Viewer.prototype={setCsg:function(e){this.meshes=OpenJsCad.Viewer.csgToMeshes(e),this.onDraw()},clear:function(){this.meshes=[],this.onDraw()},supported:function(){return!!this.gl},ZOOM_MAX:1e3,ZOOM_MIN:10,onZoomChanged:null,setZoom:function(e){e=Math.max(e,0),e=Math.min(e,1),this.viewpointZ=this.ZOOM_MIN+e*(this.ZOOM_MAX-this.ZOOM_MIN),this.onZoomChanged&&this.onZoomChanged(),this.onDraw()},getZoom:function(){return(this.viewpointZ-this.ZOOM_MIN)/(this.ZOOM_MAX-this.ZOOM_MIN)},onMouseMove:function(e){if(e.dragging){if(e.preventDefault(),e.altKey)this.angleZ+=2*e.deltaX,this.angleX+=2*e.deltaY;else if(e.shiftKey){this.viewpointX+=.005*e.deltaX*this.viewpointZ,this.viewpointY-=.005*e.deltaY*this.viewpointZ}else this.angleY+=2*e.deltaX,this.angleX+=2*e.deltaY;this.onDraw()}},onDraw:function(e){var t=this.gl;t.makeCurrent(),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.loadIdentity(),t.translate(this.viewpointX,this.viewpointY,-this.viewpointZ),t.rotate(this.angleX,1,0,0),t.rotate(this.angleY,0,1,0),t.rotate(this.angleZ,0,0,1),this.lineOverlay||t.enable(t.POLYGON_OFFSET_FILL);for(var n=0;n<this.meshes.length;n++){var i=this.meshes[n];this.lightingShader.draw(i,t.TRIANGLES)}if(this.lineOverlay||t.disable(t.POLYGON_OFFSET_FILL),this.drawLines){this.lineOverlay&&t.disable(t.DEPTH_TEST),t.enable(t.BLEND);for(n=0;n<this.meshes.length;n++){i=this.meshes[n];this.blackShader.draw(i,t.LINES)}t.disable(t.BLEND),this.lineOverlay&&t.enable(t.DEPTH_TEST)}this.drawAxes&&(t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.begin(t.LINES),t.color(1,.5,.5,.2),t.vertex(-100,0,0),t.vertex(0,0,0),t.color(1,0,0,.8),t.vertex(0,0,0),t.vertex(100,0,0),t.color(.5,1,.5,.2),t.vertex(0,-100,0),t.vertex(0,0,0),t.color(0,1,0,.8),t.vertex(0,0,0),t.vertex(0,100,0),t.color(.5,.5,.5,.2),t.vertex(0,0,-100),t.vertex(0,0,0),t.color(.2,.2,.2,.8),t.vertex(0,0,0),t.vertex(0,0,100),t.end(),t.disable(t.BLEND))}},OpenJsCad.Viewer.csgToMeshes=function(e){e=e.canonicalized();for(var t=new GL.Mesh({normals:!0,colors:!0}),n=[t],i={},r=[],o=[],s=[],a=e.toPolygons(),l=a.length,h=0;h<l;h++){var c=a[h],d=[0,0,1];c.shared&&c.shared.color&&(d=c.shared.color);for(var u=c.vertices.map((function(e){var t,n=e.getTag();return t=r.length,i[n]=t,r.push([e.pos.x,e.pos.y,e.pos.z]),o.push(d),t})),p=2;p<u.length;p++)s.push([u[0],u[p-1],u[p]]);r.length>65e3&&(t.triangles=s,t.vertices=r,t.colors=o,t.computeWireframe(),t.computeNormals(),t=new GL.Mesh({normals:!0,colors:!0}),s=[],o=[],r=[],n.push(t))}return t.triangles=s,t.vertices=r,t.colors=o,t.computeWireframe(),t.computeNormals(),n},OpenJsCad.makeAbsoluteUrl=function(e,t){if(!e.match(/^[a-z]+\:/i)){var n=t.split("/");n.length>0&&n.splice(n.length-1,1);var i=e.split("/"),r=n.concat(i),o=[];r.map((function(e){".."==e?o.length>0&&o.splice(o.length-1,1):o.push(e)})),e="";for(var s=0;s<o.length;s++)s>0&&(e+="/"),e+=o[s]}return e},OpenJsCad.isChrome=function(){return navigator.userAgent.search("Chrome")>=0},OpenJsCad.runMainInWorker=function(e){try{if("function"!=typeof main)throw new Error("Your jscad file should contain a function main() which returns a CSG solid or a CAG area.");OpenJsCad.log.prevLogTime=Date.now();var t=main(e);if(!("object"==typeof t&&(t instanceof CSG||t instanceof CAG)))throw new Error("Your main() function should return a CSG solid or a CAG area.");var n=t.toCompactBinary();t=null,self.postMessage({cmd:"rendered",result:n})}catch(e){var i=e.stack;i||(i=e.toString()),self.postMessage({cmd:"error",err:i})}},OpenJsCad.parseJsCadScriptSync=function(e,t,n){var i="";i+=e,n&&(i+="\n\n\n\n\n\n\n/* -------------------------------------------------------------------------\n",i+="OpenJsCad debugging\n\nAssuming you are running Chrome:\nF10 steps over an instruction\nF11 steps into an instruction\n",i+="F8  continues running\nPress the (||) button at the bottom to enable pausing whenever an error occurs\n",i+="Click on a line number to set or clear a breakpoint\n",i+="For more information see: http://code.google.com/chrome/devtools/docs/overview.html\n\n",i+="------------------------------------------------------------------------- */\n",i+="\n\n// Now press F11 twice to enter your main() function:\n\n",i+="debugger;\n"),i+="return main("+JSON.stringify(t)+");";var r=new Function(i);return OpenJsCad.log.prevLogTime=Date.now(),r()},OpenJsCad.parseJsCadScriptASync=function(e,t,n,i){var r=document.location.href.replace(/\?.*$/,""),o=r;null!=n.openJsCadPath&&(o=OpenJsCad.makeAbsoluteUrl(n.openJsCadPath,r));var s=[];null!=n.libraries&&(s=n.libraries);var a="";a+=e,a+="\n\n\n\n//// The following code is added by OpenJsCad:\n",a+="var _csg_baselibraries="+JSON.stringify(["../cdn/csg2.js","../cdn/openjscad.js"])+";\n",a+="var _csg_libraries="+JSON.stringify(s)+";\n",a+="var _csg_baseurl="+JSON.stringify(r)+";\n",a+="var _csg_openjscadurl="+JSON.stringify(o)+";\n",a+="var _csg_makeAbsoluteURL="+OpenJsCad.makeAbsoluteUrl.toString()+";\n",a+="_csg_baselibraries = _csg_baselibraries.map(function(l){return _csg_makeAbsoluteURL(l,_csg_openjscadurl);});\n",a+="_csg_libraries = _csg_libraries.map(function(l){return _csg_makeAbsoluteURL(l,_csg_baseurl);});\n",a+="_csg_baselibraries.map(function(l){importScripts(l)});\n",a+="_csg_libraries.map(function(l){importScripts(l)});\n",a+="self.addEventListener('message', function(e) {if(e.data && e.data.cmd == 'render'){",a+="  OpenJsCad.runMainInWorker("+JSON.stringify(t)+");",a+="}},false);\n";var l=OpenJsCad.textToBlobUrl(a);if(!window.Worker)throw new Error("Your browser doesn't support Web Workers. Please try the Chrome browser instead.");var h=new Worker(l);return h.onmessage=function(e){if(e.data)if("rendered"==e.data.cmd){var t,n=e.data.result.class;if("CSG"==n)t=CSG.fromCompactBinary(e.data.result);else{if("CAG"!=n)throw new Error("Cannot parse result");t=CAG.fromCompactBinary(e.data.result)}i(null,t)}else"error"==e.data.cmd?i(e.data.err,null):"log"==e.data.cmd&&e.data.txt},h.onerror=function(e){var t="Error in line "+e.lineno+": "+e.message;i(t,null)},h.postMessage({cmd:"render"}),h},OpenJsCad.getWindowURL=function(){if(window.URL)return window.URL;if(window.webkitURL)return window.webkitURL;throw new Error("Your browser doesn't support window.URL")},OpenJsCad.textToBlobUrl=function(e){var t=OpenJsCad.getWindowURL(),n=new Blob([e]),i=t.createObjectURL(n);if(!i)throw new Error("createObjectURL() failed");return i},OpenJsCad.revokeBlobUrl=function(e){if(window.URL)window.URL.revokeObjectURL(e);else{if(!window.webkitURL)throw new Error("Your browser doesn't support window.URL");window.webkitURL.revokeObjectURL(e)}},OpenJsCad.FileSystemApiErrorHandler=function(e,t){var n,i={1:"NOT_FOUND_ERR",2:"SECURITY_ERR",3:"ABORT_ERR",4:"NOT_READABLE_ERR",5:"ENCODING_ERR",6:"NO_MODIFICATION_ALLOWED_ERR",7:"INVALID_STATE_ERR",8:"SYNTAX_ERR",9:"INVALID_MODIFICATION_ERR",10:"QUOTA_EXCEEDED_ERR",11:"TYPE_MISMATCH_ERR",12:"PATH_EXISTS_ERR"};throw n=e.code in i?i[e.code]:"Error #"+e.code,new Error("FileSystem API error: "+t+" returned error "+n)},OpenJsCad.AlertUserOfUncaughtExceptions=function(){window.onerror=function(e,t,n){e=e.replace(/^Uncaught /i,""),alert(e+"\n\n("+t+" line "+n+")")}},OpenJsCad.getParamDefinitions=function(e){var t=!0;try{new Function(e)()}catch(e){t=!1}var n=[];if(t){var i="if(typeof(getParameterDefinitions) == 'function') {return getParameterDefinitions();} else {return [];} ";if("object"!=typeof(n=new Function(i+=e)())||"number"!=typeof n.length)throw new Error("The getParameterDefinitions() function should return an array with the parameter definitions")}return n},OpenJsCad.Processor=function(e,t){this.containerdiv=e,this.onchange=t,this.viewerdiv=null,this.viewer=null,this.zoomControl=null,this.viewerwidth=800,this.viewerheight=600,this.initialViewerDistance=200,this.processing=!1,this.currentObject=null,this.hasValidCurrentObject=!1,this.hasOutputFile=!1,this.worker=null,this.paramDefinitions=[],this.paramControls=[],this.script=null,this.hasError=!1,this.debugging=!1,this.options={},this.createElements()},OpenJsCad.Processor.convertToSolid=function(e){if("object"==typeof e&&e instanceof CAG)e=e.extrude({offset:[0,0,.1]});else if(!("object"==typeof e&&e instanceof CSG))throw new Error("Cannot convert to solid");return e},OpenJsCad.Processor.prototype={createElements:function(){for(var e=this;this.containerdiv.children.length>0;)this.containerdiv.removeChild(0);var t=document.createElement("div");t.className="viewer",t.style.width=this.viewerwidth+"px",t.style.height=this.viewerheight+"px",t.style.backgroundColor="rgb(200,200,200)",this.containerdiv.appendChild(t),this.viewerdiv=t;try{this.viewer=new OpenJsCad.Viewer(this.viewerdiv,this.viewerwidth,this.viewerheight,this.initialViewerDistance)}catch(e){this.viewerdiv.innerHTML="<b><br><br>Error: "+e.toString()+"</b><br><br>OpenJsCad currently requires Google Chrome with WebGL enabled"}var n=document.createElement("div");this.zoomControl=n.cloneNode(!1),this.zoomControl.style.width=this.viewerwidth+"px",this.zoomControl.style.height="20px",this.zoomControl.style.backgroundColor="transparent",this.zoomControl.style.overflowX="scroll",n.style.width=11*this.viewerwidth+"px",n.style.height="1px",this.zoomControl.appendChild(n),this.zoomChangedBySlider=!1,this.zoomControl.onscroll=function(t){var n=e.zoomControl,i=n.scrollLeft/(10*n.offsetWidth);e.zoomChangedBySlider=!0,e.viewer.setZoom(i),e.zoomChangedBySlider=!1},this.viewer.onZoomChanged=function(){if(!e.zoomChangedBySlider){var t=e.viewer.getZoom();e.zoomControl.scrollLeft=t*(10*e.zoomControl.offsetWidth)}},this.containerdiv.appendChild(this.zoomControl),this.zoomControl.scrollLeft=this.viewer.viewpointZ/this.viewer.ZOOM_MAX*(this.zoomControl.scrollWidth-this.zoomControl.offsetWidth),this.errordiv=document.createElement("div"),this.errorpre=document.createElement("pre"),this.errordiv.appendChild(this.errorpre),this.statusdiv=document.createElement("div"),this.statusdiv.className="statusdiv",this.statusspan=document.createElement("span"),this.statusbuttons=document.createElement("div"),this.statusbuttons.style.float="right",this.statusdiv.appendChild(this.statusspan),this.statusdiv.appendChild(this.statusbuttons),this.abortbutton=document.createElement("button"),this.abortbutton.innerHTML="Abort",this.abortbutton.onclick=function(t){e.abort()},this.statusbuttons.appendChild(this.abortbutton),this.formatDropdown=document.createElement("select"),this.formatDropdown.onchange=function(t){e.currentFormat=e.formatDropdown.options[e.formatDropdown.selectedIndex].value,e.updateDownloadLink()},this.statusbuttons.appendChild(this.formatDropdown),this.generateOutputFileButton=document.createElement("button"),this.generateOutputFileButton.onclick=function(t){e.generateOutputFile()},this.statusbuttons.appendChild(this.generateOutputFileButton),this.downloadOutputFileLink=document.createElement("a"),this.statusbuttons.appendChild(this.downloadOutputFileLink),this.parametersdiv=document.createElement("div"),this.parametersdiv.className="parametersdiv";var i=document.createElement("div");i.innerText="Parameters:",i.className="header",this.parametersdiv.appendChild(i),this.parameterstable=document.createElement("table"),this.parameterstable.className="parameterstable",this.parametersdiv.appendChild(this.parameterstable);var r=document.createElement("button");r.innerHTML="Update",r.onclick=function(t){e.rebuildSolid()},this.parametersdiv.appendChild(r),this.enableItems(),this.containerdiv.appendChild(this.statusdiv),this.containerdiv.appendChild(this.errordiv),this.containerdiv.appendChild(this.parametersdiv),this.clearViewer()},setCurrentObject:function(e){if(this.currentObject=e,this.viewer){var t=OpenJsCad.Processor.convertToSolid(e);this.viewer.setCsg(t)}for(this.hasValidCurrentObject=!0;this.formatDropdown.options.length>0;)this.formatDropdown.options.remove(0);var n=this;this.supportedFormatsForCurrentObject().forEach((function(e){var t=document.createElement("option");t.setAttribute("value",e),t.appendChild(document.createTextNode(n.formatInfo(e).displayName)),n.formatDropdown.options.add(t)})),this.updateDownloadLink()},selectedFormat:function(){return this.formatDropdown.options[this.formatDropdown.selectedIndex].value},selectedFormatInfo:function(){return this.formatInfo(this.selectedFormat())},updateDownloadLink:function(){var e=this.selectedFormatInfo().extension;this.generateOutputFileButton.innerHTML="Generate "+e.toUpperCase()},clearViewer:function(){this.clearOutputFile(),this.setCurrentObject(new CSG),this.hasValidCurrentObject=!1,this.enableItems()},abort:function(){this.processing&&(this.processing=!1,this.statusspan.innerHTML="Aborted.",this.worker.terminate(),this.enableItems(),this.onchange&&this.onchange())},enableItems:function(){this.abortbutton.style.display=this.processing?"inline":"none",this.formatDropdown.style.display=!this.hasOutputFile&&this.hasValidCurrentObject?"inline":"none",this.generateOutputFileButton.style.display=!this.hasOutputFile&&this.hasValidCurrentObject?"inline":"none",this.downloadOutputFileLink.style.display=this.hasOutputFile?"inline":"none",this.parametersdiv.style.display=this.paramControls.length>0?"block":"none",this.errordiv.style.display=this.hasError?"block":"none",this.statusdiv.style.display=this.hasError?"none":"block"},setOpenJsCadPath:function(e){this.options.openJsCadPath=e},addLibrary:function(e){null==this.options.libraries&&(this.options.libraries=[]),this.options.libraries.push(e)},setError:function(e){this.hasError=""!=e,this.errorpre.innerText=e,this.enableItems()},setDebugging:function(e){this.debugging=e},setJsCad:function(e,t){t||(t="openjscad.jscad"),t=t.replace(/\.jscad$/i,""),this.abort(),this.clearViewer(),this.paramDefinitions=[],this.paramControls=[],this.script=null,this.setError("");var n=!1;try{this.paramDefinitions=OpenJsCad.getParamDefinitions(e),this.createParamControls()}catch(e){this.setError(e.toString()),this.statusspan.innerHTML="Error.",n=!0}n?(this.enableItems(),this.onchange&&this.onchange()):(this.script=e,this.filename=t,this.rebuildSolid())},getParamValues:function(){for(var e={},t=0;t<this.paramDefinitions.length;t++){var n=this.paramDefinitions[t],i="text";"type"in n&&(i=n.type);var r,o=this.paramControls[t];if("text"==i||"float"==i||"int"==i){if(r=o.value,"float"==i||"int"==i){if(!(!isNaN(parseFloat(r))&&isFinite(r)))throw new Error("Not a number: "+r);r="int"==i?parseInt(r):parseFloat(r)}}else"choice"==i&&(r=o.options[o.selectedIndex].value);e[n.name]=r}return e},rebuildSolid:function(){this.abort(),this.setError(""),this.clearViewer(),this.processing=!0,this.statusspan.innerHTML="Processing, please wait...",this.enableItems();var e=this,t=this.getParamValues(),n=this.debugging;if(!n)try{this.worker=OpenJsCad.parseJsCadScriptASync(this.script,t,this.options,(function(t,n){e.processing=!1,e.worker=null,t?(e.setError(t),e.statusspan.innerHTML="Error."):(e.setCurrentObject(n),e.statusspan.innerHTML="Ready."),e.enableItems(),e.onchange&&e.onchange()}))}catch(e){n=!0}if(n){try{var i=OpenJsCad.parseJsCadScriptSync(this.script,t,this.debugging);e.setCurrentObject(i),e.processing=!1,e.statusspan.innerHTML="Ready."}catch(t){e.processing=!1;var r=t.stack;r||(r=t.toString()),e.setError(r),e.statusspan.innerHTML="Error."}e.enableItems(),e.onchange&&e.onchange()}},hasSolid:function(){return this.hasValidCurrentObject},isProcessing:function(){return this.processing},clearOutputFile:function(){this.hasOutputFile&&(this.hasOutputFile=!1,this.outputFileDirEntry&&(this.outputFileDirEntry.removeRecursively((function(){})),this.outputFileDirEntry=null),this.outputFileBlobUrl&&(OpenJsCad.revokeBlobUrl(this.outputFileBlobUrl),this.outputFileBlobUrl=null),this.enableItems(),this.onchange&&this.onchange())},generateOutputFile:function(){if(this.clearOutputFile(),this.hasValidCurrentObject)try{this.generateOutputFileFileSystem()}catch(e){this.generateOutputFileBlobUrl()}},currentObjectToBlob:function(){var e,t=this.selectedFormat();if("stl"==t)e=this.currentObject.fixTJunctions().toStlBinary();else if("x3d"==t)e=this.currentObject.fixTJunctions().toX3D(bb);else{if("dxf"!=t)throw new Error("Not supported");e=this.currentObject.toDxf()}return e},supportedFormatsForCurrentObject:function(){if(this.currentObject instanceof CSG)return["stl","x3d"];if(this.currentObject instanceof CAG)return["dxf"];throw new Error("Not supported")},formatInfo:function(e){return{stl:{displayName:"STL",extension:"stl",mimetype:"application/sla"},x3d:{displayName:"X3D",extension:"x3d",mimetype:"model/x3d+xml"},dxf:{displayName:"DXF",extension:"dxf",mimetype:"application/dxf"}}[e]},downloadLinkTextForCurrentObject:function(){return"Download "+this.selectedFormatInfo().extension.toUpperCase()},generateOutputFileBlobUrl:function(){var e=this.currentObjectToBlob(),t=OpenJsCad.getWindowURL();if(this.outputFileBlobUrl=t.createObjectURL(e),!this.outputFileBlobUrl)throw new Error("createObjectURL() failed");this.hasOutputFile=!0,this.downloadOutputFileLink.href=this.outputFileBlobUrl,this.downloadOutputFileLink.innerHTML=this.downloadLinkTextForCurrentObject();var n=this.selectedFormatInfo().extension;this.downloadOutputFileLink.setAttribute("download","openjscad."+n),this.enableItems(),this.onchange&&this.onchange()},generateOutputFileFileSystem:function(){if(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,!window.requestFileSystem)throw new Error("Your browser does not support the HTML5 FileSystem API. Please try the Chrome browser instead.");var e="OpenJsCadOutput1_"+parseInt(1e9*Math.random(),10)+"."+t,t=this.selectedFormatInfo().extension,n=this.filename+"."+t,i=this;window.requestFileSystem(TEMPORARY,20971520,(function(t){t.root.getDirectory(e,{create:!0,exclusive:!0},(function(e){i.outputFileDirEntry=e,e.getFile(n,{create:!0,exclusive:!0},(function(e){e.createWriter((function(t){t.onwriteend=function(t){i.hasOutputFile=!0,i.downloadOutputFileLink.href=e.toURL(),i.downloadOutputFileLink.type=i.selectedFormatInfo().mimetype,i.downloadOutputFileLink.innerHTML=i.downloadLinkTextForCurrentObject(),i.downloadOutputFileLink.setAttribute("download",e.name),i.enableItems(),i.onchange&&i.onchange()},t.onerror=function(e){throw new Error("Write failed: "+e.toString())};var n=i.currentObjectToBlob();t.write(n)}),(function(e){OpenJsCad.FileSystemApiErrorHandler(e,"createWriter")}))}),(function(e){OpenJsCad.FileSystemApiErrorHandler(e,"getFile('"+n+"')")}))}),(function(t){OpenJsCad.FileSystemApiErrorHandler(t,"getDirectory('"+e+"')")}))}),(function(e){OpenJsCad.FileSystemApiErrorHandler(e,"requestFileSystem")}))},createParamControls:function(){this.parameterstable.innerHTML="",this.paramControls=[];for(var e=[],t=[],n=0;n<this.paramDefinitions.length;n++){var i="Error in parameter definition #"+(n+1)+": ",r=this.paramDefinitions[n];if(!("name"in r))throw new Error(i+"Should include a 'name' parameter");var o,s="text";if("type"in r&&(s=r.type),"text"!==s&&"int"!==s&&"float"!==s&&"choice"!==s)throw new Error(i+"Unknown parameter type '"+s+"'");if("text"==s||"int"==s||"float"==s)(o=document.createElement("input")).type="text",o.value="default"in r?r.default:"int"==s||"float"==s?"0":"";else if("choice"==s){if(!("values"in r))throw new Error(i+"Should include a 'values' parameter");o=document.createElement("select");var a,l=r.values;if("captions"in r){if((a=r.captions).length!=l.length)throw new Error(i+"'captions' and 'values' should have the same number of items")}else a=l;for(var h=0,c=0;c<l.length;c++){var d=document.createElement("option");d.value=l[c],d.text=a[c],o.add(d),"default"in r&&r.default==l[c]&&(h=c)}l.length>0&&(o.selectedIndex=h)}e.push(o);var u=document.createElement("tr"),p=document.createElement("td"),m=r.name+":";"caption"in r&&(m=r.caption),p.innerHTML=m,u.appendChild(p),(p=document.createElement("td")).appendChild(o),u.appendChild(p),t.push(u)}var f=this;t.map((function(e){f.parameterstable.appendChild(e)})),this.paramControls=e}};