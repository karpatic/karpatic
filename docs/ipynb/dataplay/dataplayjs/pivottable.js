var PivotData,addSeparators,aggregatorTemplates,aggregators,dayNamesEn,derivers,getSort,locales,mthNamesEn,naturalSort,numberFormat,pivotTableRenderer,rd,renderers,rx,rz,sortAs,usFmt,usFmtInt,usFmtPct,zeroPad,tpl,indexOf=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1},slice=[].slice,bind=function(t,e){return function(){return t.apply(e,arguments)}},hasProp={}.hasOwnProperty;function deepMerge(t,...e){if(!e.length)return t;const r=e.shift();if(isObject(t)&&isObject(r))for(const e in r)isObject(r[e])?(t[e]||Object.assign(t,{[e]:{}}),deepMerge(t[e],r[e])):Object.assign(t,{[e]:r[e]});return deepMerge(t,...e)}function isObject(t){return t&&"object"==typeof t&&!Array.isArray(t)}addSeparators=function(t,e,r){var n,a,l,o;for(l=(a=(t+="").split("."))[0],o=a.length>1?r+a[1]:"",n=/(\d+)(\d{3})/;n.test(l);)l=l.replace(n,"$1"+e+"$2");return l+o},usFmt=(numberFormat=function(t){return t=deepMerge({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},t),function(e){var r;return isNaN(e)||!isFinite(e)?"":(r=addSeparators((t.scaler*e).toFixed(t.digitsAfterDecimal),t.thousandsSep,t.decimalSep),""+t.prefix+r+t.suffix)}})(),usFmtInt=numberFormat({digitsAfterDecimal:0}),usFmtPct=numberFormat({digitsAfterDecimal:1,scaler:100,suffix:"%"}),(aggregatorTemplates={count:function(t){return null==t&&(t=usFmtInt),function(){return function(e,r,n){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:t}}}},uniques:function(t,e){return null==e&&(e=usFmtInt),function(r){var n;return n=r[0],function(r,a,l){return{uniq:[],push:function(t){var e;if(e=t[n],indexOf.call(this.uniq,e)<0)return this.uniq.push(t[n])},value:function(){return t(this.uniq)},format:e,numInputs:null!=n?0:1}}}},sum:function(t){return null==t&&(t=usFmt),function(e){var r;return r=e[0],function(e,n,a){return{sum:0,push:function(t){if(!isNaN(parseFloat(t[r])))return this.sum+=parseFloat(t[r])},value:function(){return this.sum},format:t,numInputs:null!=r?0:1}}}},extremes:function(t,e){return null==e&&(e=usFmt),function(r){var n;return n=r[0],function(r,a,l){return{val:null,sorter:getSort(null!=r?r.sorters:void 0,n),push:function(e){var r,a,l,o;if(o=e[n],"min"!==t&&"max"!==t||(o=parseFloat(o),isNaN(o)||(this.val=Math[t](o,null!=(r=this.val)?r:o))),"first"===t&&this.sorter(o,null!=(a=this.val)?a:o)<=0&&(this.val=o),"last"===t&&this.sorter(o,null!=(l=this.val)?l:o)>=0)return this.val=o},value:function(){return this.val},format:function(t){return isNaN(t)?t:e(t)},numInputs:null!=n?0:1}}}},quantile:function(t,e){return null==e&&(e=usFmt),function(r){var n;return n=r[0],function(r,a,l){return{vals:[],push:function(t){var e;if(e=parseFloat(t[n]),!isNaN(e))return this.vals.push(e)},value:function(){var e;return 0===this.vals.length?null:(this.vals.sort((function(t,e){return t-e})),e=(this.vals.length-1)*t,(this.vals[Math.floor(e)]+this.vals[Math.ceil(e)])/2)},format:e,numInputs:null!=n?0:1}}}},runningStat:function(t,e,r){return null==t&&(t="mean"),null==e&&(e=1),null==r&&(r=usFmt),function(n){var a;return a=n[0],function(n,l,o){return{n:0,m:0,s:0,push:function(t){var e,r;if(r=parseFloat(t[a]),!isNaN(r))return this.n+=1,1===this.n?this.m=r:(e=this.m+(r-this.m)/this.n,this.s=this.s+(r-this.m)*(r-e),this.m=e)},value:function(){if("mean"===t)return 0===this.n?NaN:this.m;if(this.n<=e)return 0;switch(t){case"var":return this.s/(this.n-e);case"stdev":return Math.sqrt(this.s/(this.n-e))}},format:r,numInputs:null!=a?0:1}}}},sumOverSum:function(t){return null==t&&(t=usFmt),function(e){var r,n;return n=e[0],r=e[1],function(e,a,l){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[n]))||(this.sumNum+=parseFloat(t[n])),!isNaN(parseFloat(t[r])))return this.sumDenom+=parseFloat(t[r])},value:function(){return this.sumNum/this.sumDenom},format:t,numInputs:null!=n&&null!=r?0:2}}}},sumOverSumBound80:function(t,e){return null==t&&(t=!0),null==e&&(e=usFmt),function(r){var n,a;return a=r[0],n=r[1],function(r,l,o){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[a]))||(this.sumNum+=parseFloat(t[a])),!isNaN(parseFloat(t[n])))return this.sumDenom+=parseFloat(t[n])},value:function(){var e;return e=t?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*e*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:e,numInputs:null!=a&&null!=n?0:2}}}},fractionOf:function(t,e,r){return null==e&&(e="total"),null==r&&(r=usFmtPct),function(){var n;return n=1<=arguments.length?slice.call(arguments,0):[],function(a,l,o){return{selector:{total:[[],[]],row:[l,[]],col:[[],o]}[e],inner:t.apply(null,n)(a,l,o),push:function(t){return this.inner.push(t)},format:r,value:function(){return this.inner.value()/a.getAggregator.apply(a,this.selector).inner.value()},numInputs:t.apply(null,n)().numInputs}}}}}).countUnique=function(t){return aggregatorTemplates.uniques((function(t){return t.length}),t)},aggregatorTemplates.listUnique=function(t){return aggregatorTemplates.uniques((function(e){return e.sort(naturalSort).join(t)}),(function(t){return t}))},aggregatorTemplates.max=function(t){return aggregatorTemplates.extremes("max",t)},aggregatorTemplates.min=function(t){return aggregatorTemplates.extremes("min",t)},aggregatorTemplates.first=function(t){return aggregatorTemplates.extremes("first",t)},aggregatorTemplates.last=function(t){return aggregatorTemplates.extremes("last",t)},aggregatorTemplates.median=function(t){return aggregatorTemplates.quantile(.5,t)},aggregatorTemplates.average=function(t){return aggregatorTemplates.runningStat("mean",1,t)},aggregatorTemplates.var=function(t,e){return aggregatorTemplates.runningStat("var",t,e)},aggregatorTemplates.stdev=function(t,e){return aggregatorTemplates.runningStat("stdev",t,e)},aggregators={Count:(tpl=aggregatorTemplates).count(usFmtInt),"Count Unique Values":tpl.countUnique(usFmtInt),"List Unique Values":tpl.listUnique(", "),Sum:tpl.sum(usFmt),"Integer Sum":tpl.sum(usFmtInt),Average:tpl.average(usFmt),Median:tpl.median(usFmt),"Sample Variance":tpl.var(1,usFmt),"Sample Standard Deviation":tpl.stdev(1,usFmt),Minimum:tpl.min(usFmt),Maximum:tpl.max(usFmt),First:tpl.first(usFmt),Last:tpl.last(usFmt),"Sum over Sum":tpl.sumOverSum(usFmt),"80% Upper Bound":tpl.sumOverSumBound80(!0,usFmt),"80% Lower Bound":tpl.sumOverSumBound80(!1,usFmt),"Sum as Fraction of Total":tpl.fractionOf(tpl.sum(),"total",usFmtPct),"Sum as Fraction of Rows":tpl.fractionOf(tpl.sum(),"row",usFmtPct),"Sum as Fraction of Columns":tpl.fractionOf(tpl.sum(),"col",usFmtPct),"Count as Fraction of Total":tpl.fractionOf(tpl.count(),"total",usFmtPct),"Count as Fraction of Rows":tpl.fractionOf(tpl.count(),"row",usFmtPct),"Count as Fraction of Columns":tpl.fractionOf(tpl.count(),"col",usFmtPct)},locales={en:{aggregators:aggregators,renderers:renderers={Table:function(t,e){return pivotTableRenderer(t,e)},"Table Barchart":function(t,e){return $(pivotTableRenderer(t,e)).barchart()},Heatmap:function(t,e){return $(pivotTableRenderer(t,e)).heatmap("heatmap",e)},"Row Heatmap":function(t,e){return $(pivotTableRenderer(t,e)).heatmap("rowheatmap",e)},"Col Heatmap":function(t,e){return $(pivotTableRenderer(t,e)).heatmap("colheatmap",e)}},localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter values",apply:"Apply",cancel:"Cancel",totals:"Totals",vs:"vs",by:"by"}}},mthNamesEn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNamesEn=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],zeroPad=function(t){return("0"+t).substr(-2,2)},derivers={bin:function(t,e){return function(r){return r[t]-r[t]%e}},dateFormat:function(t,e,r,n,a){var l;return null==r&&(r=!1),null==n&&(n=mthNamesEn),null==a&&(a=dayNamesEn),l=r?"UTC":"",function(r){var o;return o=new Date(Date.parse(r[t])),isNaN(o)?"":e.replace(/%(.)/g,(function(t,e){switch(e){case"y":return o["get"+l+"FullYear"]();case"m":return zeroPad(o["get"+l+"Month"]()+1);case"n":return n[o["get"+l+"Month"]()];case"d":return zeroPad(o["get"+l+"Date"]());case"w":return a[o["get"+l+"Day"]()];case"x":return o["get"+l+"Day"]();case"H":return zeroPad(o["get"+l+"Hours"]());case"M":return zeroPad(o["get"+l+"Minutes"]());case"S":return zeroPad(o["get"+l+"Seconds"]());default:return"%"+e}}))}}},rx=/(\d+)|(\D+)/g,rd=/\d/,rz=/^0/,naturalSort=function(t,e){var r,n,a,l,o,s;if(null!=e&&null==t)return-1;if(null!=t&&null==e)return 1;if("number"==typeof t&&isNaN(t))return-1;if("number"==typeof e&&isNaN(e))return 1;if((o=+t)<(s=+e))return-1;if(o>s)return 1;if("number"==typeof t&&"number"!=typeof e)return-1;if("number"==typeof e&&"number"!=typeof t)return 1;if("number"==typeof t&&"number"==typeof e)return 0;if(isNaN(s)&&!isNaN(o))return-1;if(isNaN(o)&&!isNaN(s))return 1;if((r=String(t))===(a=String(e)))return 0;if(!rd.test(r)||!rd.test(a))return r>a?1:-1;for(r=r.match(rx),a=a.match(rx);r.length&&a.length;)if((n=r.shift())!==(l=a.shift()))return rd.test(n)&&rd.test(l)?n.replace(rz,".0")-l.replace(rz,".0"):n>l?1:-1;return r.length-a.length},sortAs=function(t){var e,r,n,a;for(e in n={},r={},t)a=t[e],n[a]=e,"string"==typeof a&&(r[a.toLowerCase()]=e);return function(t,e){return null!=n[t]&&null!=n[e]?n[t]-n[e]:null!=n[t]?-1:null!=n[e]?1:null!=r[t]&&null!=r[e]?r[t]-r[e]:null!=r[t]?-1:null!=r[e]?1:naturalSort(t,e)}},getSort=function(t,e){var r;if(null!=t)if("function"==typeof t){if("function"==typeof(r=t(e)))return r}else if(null!=t[e])return t[e];return naturalSort},PivotData=function(){function PivotData(t,e){var r,n,a,l,o,s,i,u,c,d,p;null==e&&(e={}),this.getAggregator=bind(this.getAggregator,this),this.getRowKeys=bind(this.getRowKeys,this),this.getColKeys=bind(this.getColKeys,this),this.sortKeys=bind(this.sortKeys,this),this.arrSort=bind(this.arrSort,this),this.input=t,this.aggregator=null!=(r=e.aggregator)?r:aggregatorTemplates.count()(),this.aggregatorName=null!=(n=e.aggregatorName)?n:"Count",this.colAttrs=null!=(a=e.cols)?a:[],this.rowAttrs=null!=(l=e.rows)?l:[],this.valAttrs=null!=(o=e.vals)?o:[],this.sorters=null!=(s=e.sorters)?s:{},this.rowOrder=null!=(i=e.rowOrder)?i:"key_a_to_z",this.colOrder=null!=(u=e.colOrder)?u:"key_a_to_z",this.derivedAttributes=null!=(c=e.derivedAttributes)?c:{},this.filter=null!=(d=e.filter)?d:function(){return!0},this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,PivotData.forEachRecord(this.input,this.derivedAttributes,(p=this,function(t){if(p.filter(t))return p.processRecord(t)}))}return PivotData.forEachRecord=function(t,e,r){var n,a,l,o,s,i,u,c,d,p,h;if(n=0===Object.keys(e).length?r:function(t){var n,a,l;for(n in e)l=e[n],t[n]=null!=(a=l(t))?a:t[n];return r(t)},"function"==typeof t)return t(n);if(Array.isArray(t)){if(Array.isArray(t[0])){for(l in d=[],t)if(hasProp.call(t,l)&&(a=t[l],l>0)){for(o in u={},c=t[0])hasProp.call(c,o)&&(u[c[o]]=a[o]);d.push(n(u))}return d}for(p=[],s=0,i=t.length;s<i;s++)u=t[s],p.push(n(u));return p}if(!(t instanceof HTMLElement))throw new Error("unknown input format");h=[],t.querySelectorAll("thead > tr > th").forEach((function(t,e){h.push(t.textContent)})),t.querySelectorAll("tbody > tr").forEach((function(t,e){let r={};t.querySelectorAll("td").forEach((function(t,e){r[h[e]]=t.textContent})),n(r)}))},PivotData.prototype.forEachMatchingRecord=function(t,e){return PivotData.forEachRecord(this.input,this.derivedAttributes,(r=this,function(n){var a,l;if(r.filter(n)){for(a in t)if(t[a]!==(null!=(l=n[a])?l:"null"))return;return e(n)}}));var r},PivotData.prototype.arrSort=function(t){var e,r;return r=function(){var r,n,a;for(a=[],r=0,n=t.length;r<n;r++)e=t[r],a.push(getSort(this.sorters,e));return a}.call(this),function(t,e){var n,a;for(a in r)if(hasProp.call(r,a)&&0!==(n=(0,r[a])(t[a],e[a])))return n;return 0}},PivotData.prototype.sortKeys=function(){var t,e;if(!this.sorted){switch(this.sorted=!0,e=this,t=function(t,r){return e.getAggregator(t,r).value()},this.rowOrder){case"value_a_to_z":this.rowKeys.sort((function(e,r){return naturalSort(t(e,[]),t(r,[]))}));break;case"value_z_to_a":this.rowKeys.sort((function(e,r){return-naturalSort(t(e,[]),t(r,[]))}));break;default:this.rowKeys.sort(this.arrSort(this.rowAttrs))}switch(this.colOrder){case"value_a_to_z":return this.colKeys.sort((function(e,r){return naturalSort(t([],e),t([],r))}));case"value_z_to_a":return this.colKeys.sort((function(e,r){return-naturalSort(t([],e),t([],r))}));default:return this.colKeys.sort(this.arrSort(this.colAttrs))}}},PivotData.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},PivotData.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},PivotData.prototype.processRecord=function(t){var e,r,n,a,l,o,s,i,u,c,d,p,h;for(e=[],p=[],a=0,l=(i=this.colAttrs).length;a<l;a++)h=i[a],e.push(null!=(u=t[h])?u:"null");for(s=0,o=(c=this.rowAttrs).length;s<o;s++)h=c[s],p.push(null!=(d=t[h])?d:"null");if(n=p.join(String.fromCharCode(0)),r=e.join(String.fromCharCode(0)),this.allTotal.push(t),0!==p.length&&(this.rowTotals[n]||(this.rowKeys.push(p),this.rowTotals[n]=this.aggregator(this,p,[])),this.rowTotals[n].push(t)),0!==e.length&&(this.colTotals[r]||(this.colKeys.push(e),this.colTotals[r]=this.aggregator(this,[],e)),this.colTotals[r].push(t)),0!==e.length&&0!==p.length)return this.tree[n]||(this.tree[n]={}),this.tree[n][r]||(this.tree[n][r]=this.aggregator(this,p,e)),this.tree[n][r].push(t)},PivotData.prototype.getAggregator=function(t,e){var r,n,a;return a=t.join(String.fromCharCode(0)),n=e.join(String.fromCharCode(0)),null!=(r=0===t.length&&0===e.length?this.allTotal:0===t.length?this.colTotals[n]:0===e.length?this.rowTotals[a]:this.tree[a][n])?r:{value:function(){return null},format:function(){return""}}},PivotData}(),window.pivotUtilities={aggregatorTemplates:aggregatorTemplates,aggregators:aggregators,renderers:renderers,derivers:derivers,locales:locales,naturalSort:naturalSort,numberFormat:numberFormat,sortAs:sortAs,PivotData:PivotData},pivotTableRenderer=function(t,e){var r,n,a,l,o,s,i,u,c,d,p,h,m,f,g,v,y,b,C,S,A,E,w;for(u in e=deepMerge({},{table:{clickCallback:null,rowTotals:!0,colTotals:!0},localeStrings:{totals:"Totals"}},e),a=t.colAttrs,p=t.rowAttrs,m=t.getRowKeys(),o=t.getColKeys(),e.table.clickCallback&&(s=function(r,n,l){var o,s,i;for(i in s={},a)hasProp.call(a,i)&&(o=a[i],null!=l[i]&&(s[o]=l[i]));for(i in p)hasProp.call(p,i)&&(o=p[i],null!=n[i]&&(s[o]=n[i]));return function(n){return e.table.clickCallback(n,r,s,t)}}),(d=document.createElement("table")).className="pvtTable",f=function(t,e,r){var n,a,l,o,s,i,u,c;if(0!==e){for(o=!0,c=n=0,s=r;0<=s?n<=s:n>=s;c=0<=s?++n:--n)t[e-1][c]!==t[e][c]&&(o=!1);if(o)return-1}for(a=0;e+a<t.length;){for(u=!1,c=l=0,i=r;0<=i?l<=i:l>=i;c=0<=i?++l:--l)t[e][c]!==t[e+a][c]&&(u=!0);if(u)break;a++}return a},b=document.createElement("thead"),a)if(hasProp.call(a,u)){for(i in n=a[u],S=document.createElement("tr"),0===parseInt(u)&&0!==p.length&&((y=document.createElement("th")).setAttribute("colspan",p.length),y.setAttribute("rowspan",a.length),S.appendChild(y)),(y=document.createElement("th")).className="pvtAxisLabel",y.textContent=n,S.appendChild(y),o)hasProp.call(o,i)&&(l=o[i],-1!==(w=f(o,parseInt(i),parseInt(u)))&&((y=document.createElement("th")).className="pvtColLabel",y.textContent=l[u],y.setAttribute("colspan",w),parseInt(u)===a.length-1&&0!==p.length&&y.setAttribute("rowspan",2),S.appendChild(y)));0===parseInt(u)&&e.table.rowTotals&&((y=document.createElement("th")).className="pvtTotalLabel pvtRowTotalLabel",y.innerHTML=e.localeStrings.totals,y.setAttribute("rowspan",a.length+(0===p.length?0:1)),S.appendChild(y)),b.appendChild(S)}if(0!==p.length){for(i in S=document.createElement("tr"),p)hasProp.call(p,i)&&(c=p[i],(y=document.createElement("th")).className="pvtAxisLabel",y.textContent=c,S.appendChild(y));y=document.createElement("th"),0===a.length&&(y.className="pvtTotalLabel pvtRowTotalLabel",y.innerHTML=e.localeStrings.totals),S.appendChild(y),b.appendChild(S)}for(i in d.appendChild(b),g=document.createElement("tbody"),m)if(hasProp.call(m,i)){for(u in h=m[i],S=document.createElement("tr"),h)hasProp.call(h,u)&&(A=h[u],-1!==(w=f(m,parseInt(i),parseInt(u)))&&((y=document.createElement("th")).className="pvtRowLabel",y.textContent=A,y.setAttribute("rowspan",w),parseInt(u)===p.length-1&&0!==a.length&&y.setAttribute("colspan",2),S.appendChild(y)));for(u in o)hasProp.call(o,u)&&(l=o[u],E=(r=t.getAggregator(h,l)).value(),(v=document.createElement("td")).className="pvtVal row"+i+" col"+u,v.textContent=r.format(E),v.setAttribute("data-value",E),null!=s&&(v.onclick=s(E,h,l)),S.appendChild(v));(e.table.rowTotals||0===a.length)&&(E=(C=t.getAggregator(h,[])).value(),(v=document.createElement("td")).className="pvtTotal rowTotal",v.textContent=C.format(E),v.setAttribute("data-value",E),null!=s&&(v.onclick=s(E,h,[])),v.setAttribute("data-for","row"+i),S.appendChild(v)),g.appendChild(S)}if(e.table.colTotals||0===p.length){for(u in S=document.createElement("tr"),(e.table.colTotals||0===p.length)&&((y=document.createElement("th")).className="pvtTotalLabel pvtColTotalLabel",y.innerHTML=e.localeStrings.totals,y.setAttribute("colspan",p.length+(0===a.length?0:1)),S.appendChild(y)),o)hasProp.call(o,u)&&(l=o[u],E=(C=t.getAggregator([],l)).value(),(v=document.createElement("td")).className="pvtTotal colTotal",v.textContent=C.format(E),v.setAttribute("data-value",E),null!=s&&(v.onclick=s(E,[],l)),v.setAttribute("data-for","col"+u),S.appendChild(v));(e.table.rowTotals||0===a.length)&&(E=(C=t.getAggregator([],[])).value(),(v=document.createElement("td")).className="pvtGrandTotal",v.textContent=C.format(E),v.setAttribute("data-value",E),null!=s&&(v.onclick=s(E,[],[])),S.appendChild(v)),g.appendChild(S)}return d.appendChild(g),d.setAttribute("data-numrows",m.length),d.setAttribute("data-numcols",o.length),d},window.pivot=(t,e,r,n)=>{let a,l,o,s,i,u,c;n||(n="en"),locales[n]||(n="en"),a={cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:PivotData,filter:function(){return!0},aggregator:aggregatorTemplates.count()(),aggregatorName:"Count",sorters:{},derivedAttributes:{},renderer:pivotTableRenderer},s=deepMerge({},locales.en.localeStrings,locales[n].localeStrings),o={rendererOptions:{localeStrings:s},localeStrings:s},i=deepMerge({},o,deepMerge({},a,r));try{u=new i.dataClass(e,i);try{c=i.renderer(u,i.rendererOptions)}catch(t){l=t,"undefined"!=typeof console&&null!==console&&console.error(l.stack),c=document.createElement("span"),c.innerHTML=i.localeStrings.renderError}}catch(t){l=t,"undefined"!=typeof console&&null!==console&&console.error(l.stack),c=document.createElement("span"),c.innerHTML=i.localeStrings.computeError}t.innerHTML=c.outerHTML},window.pivotUI=(t,e,r,n,a)=>{var l,o,s,i,u,c,d,p,h,m,f,g,v,y,b,C,S,A,E,w,T,x,N,L,F,O,P,k,M,_,D,q,R,I,z,H,U,K,j,V,B,$,J;null==n&&(n=!1),null==a&&(a="en"),null==locales[a]&&(a="en"),d={derivedAttributes:{},aggregators:locales[a].aggregators,renderers:locales[a].renderers,hiddenAttributes:[],hiddenFromAggregators:[],hiddenFromDragDrop:[],menuLimit:500,cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:PivotData,exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,onRefresh:null,showUI:!0,filter:function(){return!0},sorters:{}},S={rendererOptions:{localeStrings:A=deepMerge({},locales.en.localeStrings,locales[a].localeStrings)},localeStrings:A},h=t.dataset?.pivotUIOptions||null,x=null==h||n?deepMerge({},S,deepMerge({},d,r)):h;try{i={},E=[],L=0,PivotData.forEachRecord(e,x.derivedAttributes,(function(t){var e,r,n,a;if(x.filter(t)){for(e in E.push(t),t)hasProp.call(t,e)&&null==i[e]&&(i[e]={},L>0&&(i[e].null=L));for(e in i)a=null!=(n=t[e])?n:"null",null==(r=i[e])[a]&&(r[a]=0),i[e][a]++;return L++}})),(j=document.createElement("table")).className="pvtUi",j.setAttribute("cellpadding",5),(q=document.createElement("td")).classList.add("pvtUiCell"),(D=document.createElement("select")).classList.add("pvtRenderer");let r="id_"+Math.random().toString(36).substr(2,9);for(J in D.id=r,q.appendChild(D),setTimeout((function(){(D=document.getElementById(r)).addEventListener("change",(t=>(D.value,M())))}),250),F=x.renderers){if(Object.prototype.hasOwnProperty.call(F,J))(Y=document.createElement("option")).value=J,Y.innerHTML=J,D.appendChild(Y)}if((V=document.createElement("td")).classList.add("pvtAxisContainer","pvtUnused","pvtUiCell"),I=function(){var t;for(l in t=[],i)indexOf.call(x.hiddenAttributes,l)<0&&t.push(l);return t}(),z=function(){var t,e,r;for(r=[],t=0,e=I.length;t<e;t++)u=I[t],indexOf.call(x.hiddenFromAggregators,u)<0&&r.push(u);return r}(),H=function(){var t,e,r;for(r=[],t=0,e=I.length;t<e;t++)u=I[t],indexOf.call(x.hiddenFromDragDrop,u)<0&&r.push(u);return r}(),$=!1,B="auto"===x.unusedAttrsVertical?120:parseInt(x.unusedAttrsVertical),!isNaN(B)){for(s=0,v=0,y=H.length;v<y;v++)s+=(l=H[v]).length;$=s>B}for(f in!0===x.unusedAttrsVertical||$?V.classList.add("pvtVertList"):V.classList.add("pvtHorizList"),m=function(t){var e,r,n,a,l,o,s,u,c,d;d=function(){var e;for(u in e=[],i[t])e.push(u);return e}(),a=!1,(c=document.createElement("div")).classList.add("pvtFilterBox"),c.style.display="none";let p=document.createElement("h4"),h=document.createElement("span");h.textContent=t;let m=document.createElement("span");if(m.classList.add("count"),m.textContent=`(${d.length})`,p.appendChild(h),p.appendChild(m),c.appendChild(p),d.length>x.menuLimit){let t=document.createElement("p");t.innerHTML=x.localeStrings.tooMany,c.appendChild(t)}else{if(d.length>5){let keyUpFunction=function(){var t,e,r;return r=this.value.toLowerCase().trim(),e=function(t,e){return function(n){var a,l;return 0===(a=r.substring(t.length).trim()).length||(l=Math.sign(s(n.toLowerCase(),a)),indexOf.call(e,l)>=0)}},t=0===r.indexOf(">=")?e(">=",[1,0]):0===r.indexOf("<=")?e("<=",[-1,0]):0===r.indexOf(">")?e(">",[1]):0===r.indexOf("<")?e("<",[-1]):0===r.indexOf("~")?function(t){return 0===r.substring(1).trim().length||t.toLowerCase().match(r.substring(1))}:function(t){return-1!==t.toLowerCase().indexOf(r)},c.find(".pvtCheckContainer p label span.value").each((function(){return t(this.textContent)?this.parentElement.parentElement.style.display="block":this.parentElement.parentElement.style.display="none"}))},e=c.appendChild(document.createElement("p"));s=getSort(x.sorters,t),l=x.localeStrings.filterResults;let r=document.createElement("input");r.type="text",r.placeholder=l,r.className="pvtSearch",r.addEventListener("keyup",keyUpFunction),e.appendChild(r),e.appendChild(document.createElement("br"));let n=document.createElement("button");n.type="button",n.innerHTML=x.localeStrings.selectAll,n.addEventListener("click",(function(){return c.querySelectorAll("input:visible:not(:checked)").forEach((t=>{t.checked=!0,t.classList.toggle("changed")})),!1})),e.appendChild(n);let a=document.createElement("button");a.type="button",a.innerHTML=x.localeStrings.selectNone,a.addEventListener("click",(function(){return c.querySelectorAll("input:visible:checked").forEach((t=>{t.checked=!1,t.classList.toggle("changed")})),!1})),e.appendChild(a)}let e=document.createElement("div");e.classList.add("pvtCheckContainer"),c.appendChild(e);for(let r=0,n=(o=d.sort(getSort(x.sorters,t))).length;r<n;r++){let n=o[r],l=i[t][n],s=document.createElement("label"),u=!1;x.inclusions[t]?u=!x.inclusions[t].includes(n):x.exclusions[t]&&(u=x.exclusions[t].includes(n)),a=a||u;let c=document.createElement("input");c.setAttribute("type","checkbox"),c.classList.add("pvtFilter"),c.checked=!u,c.dataset.filter=JSON.stringify([t,n]),c.addEventListener("change",(function(){this.classList.toggle("changed")})),s.appendChild(c);let d=document.createElement("span");d.classList.add("value"),d.textContent=n,s.appendChild(d);let p=document.createElement("span");p.classList.add("count"),p.textContent=`(${l})`,s.appendChild(p);let h=document.createElement("p");h.appendChild(s),e.appendChild(h)}}if(r=function(){return c.find("[type='checkbox']").length>c.find("[type='checkbox']:checked").length?e.addClass("pvtFilteredAttribute"):e.removeClass("pvtFilteredAttribute"),c.find(".pvtSearch").val(""),c.find(".pvtCheckContainer p").show(),c.hide()},n=document.createElement("p"),c.appendChild(n),d.length<=x.menuLimit){let t=document.createElement("button");t.type="button",t.textContent=x.localeStrings.apply,n.appendChild(t),t.addEventListener("click",(function(){let t=c.querySelectorAll(".changed");return t.length&&(t.forEach((t=>t.classList.remove("changed"))),M()),r()}))}let g=document.createElement("button");var v;g.type="button",g.textContent=x.localeStrings.cancel,g.addEventListener("click",(function(){return c.querySelectorAll(".changed:checked").forEach((t=>{t.classList.remove("changed"),t.checked=!1})),c.querySelectorAll(".changed:not(:checked)").forEach((t=>{t.classList.remove("changed"),t.checked=!0})),r()})),n.appendChild(g),(v=document.createElement("span")).classList.add("pvtTriangle"),v.innerHTML=" &#x25BE;",v.addEventListener("click",(function(t){var e=t.currentTarget.getBoundingClientRect(),r=e.left+window.scrollX,n=e.top+window.scrollY;c.style.left=r+10+"px",c.style.top=n+10+"px",c.style.display="block"})),(e=document.createElement("li")).classList.add("axis_"+f);const y=document.createElement("span");return y.classList.add("pvtAttr"),y.textContent=t,y.dataset.attrName=t,y.appendChild(v),e.appendChild(y),a&&e.addClass("pvtFilteredAttribute"),V.appendChild(e),V.appendChild(c),V},H)hasProp.call(H,f)&&m(H[f]);U=document.createElement("tr"),j.appendChild(U),(o=document.createElement("select")).classList.add("pvtAggregator");let n="id_"+Math.random().toString(36).substr(2,9);for(J in o.id=n,setTimeout((function(){(o=document.getElementById(n)).addEventListener("change",(t=>(o.value,M())))}),250),O=x.aggregators){var Y;if(hasProp.call(O,J))(Y=document.createElement("option")).value=J,Y.innerHTML=J,o.append(Y)}N={key_a_to_z:{rowSymbol:"&varr;",colSymbol:"&harr;",next:"value_a_to_z"},value_a_to_z:{rowSymbol:"&darr;",colSymbol:"&rarr;",next:"value_z_to_a"},value_z_to_a:{rowSymbol:"&uarr;",colSymbol:"&larr;",next:"key_a_to_z"}},(R=document.createElement("a")).setAttribute("role","button"),R.classList.add("pvtRowOrder"),R.dataset.order=x.rowOrder,R.innerHTML=N[x.rowOrder].rowSymbol,R.addEventListener("click",(function(){return this.dataset.order=N[this.dataset.order].next,this.innerHTML=N[this.dataset.order].rowSymbol,M()})),(c=document.createElement("a")).setAttribute("role","button"),c.classList.add("pvtColOrder"),c.dataset.order=x.colOrder,c.innerHTML=N[x.colOrder].colSymbol,c.addEventListener("click",(function(){return this.dataset.order=N[this.dataset.order].next,this.innerHTML=N[this.dataset.order].colSymbol,M()})),(W=document.createElement("td")).classList.add("pvtVals","pvtUiCell"),W.appendChild(o),W.appendChild(R),W.appendChild(c),W.appendChild(document.createElement("br")),U.appendChild(W),(W=document.createElement("td")).classList.add("pvtAxisContainer","pvtHorizList","pvtCols","pvtUiCell"),U.appendChild(W),K=document.createElement("tr"),j.appendChild(K);var G,W=document.createElement("td");if(W.classList.add("pvtAxisContainer","pvtRows","pvtUiCell"),W.setAttribute("valign","top"),K.appendChild(W),(G=document.createElement("td")).setAttribute("valign","top"),G.classList.add("pvtRendererArea"),K.appendChild(G),!0===x.unusedAttrsVertical||$)j.querySelector("tr:nth-child(1)").insertAdjacentElement("afterbegin",q),j.querySelector("tr:nth-child(2)").insertAdjacentElement("afterbegin",V);else{var X=document.createElement("tr");X.appendChild(q),X.appendChild(V),j.insertAdjacentElement("afterbegin",X)}for(t.innerHTML=j.outerHTML,P=x.cols,w=0,b=P.length;w<b;w++){J=P[w];let e=t.querySelector(".axis_"+H.indexOf(J));t.querySelector(".pvtCols").appendChild(e)}for(k=x.rows,T=0,C=k.length;T<C;T++){J=k[T];let e=t.querySelector(".axis_"+H.indexOf(J));t.querySelector(".pvtRows").appendChild(e)}null!=x.aggregatorName&&(t.querySelector(".pvtAggregator").value=x.aggregatorName),null!=x.rendererName&&(t.querySelector(".pvtRenderer").value=x.rendererName),x.showUI||(t.querySelector(".pvtUiCell").style.display="none"),g=!0,_=function(t){return function(){var e,r,n,a,l,s,i;o.value,s={derivedAttributes:x.derivedAttributes,localeStrings:x.localeStrings,rendererOptions:x.rendererOptions,sorters:x.sorters,cols:[],rows:[],dataClass:x.dataClass},n=null!=(l=x.aggregators[o.value]([])().numInputs)?l:0,i=[];t.querySelectorAll(".pvtRows li span.pvtAttr").forEach((t=>{s.rows.push(t.dataset.attrName)}));t.querySelectorAll(".pvtCols li span.pvtAttr").forEach((t=>{s.cols.push(t.dataset.attrName)}));if(t.querySelectorAll(".pvtVals select.pvtAttrDropdown").forEach((t=>{0===n?t.remove():(n--,""!==t.value&&i.push(t.value))})),0!==n){let e=t.querySelector(".pvtVals");for(let t=0;t<n;t++){let t=document.createElement("select");t.classList.add("pvtAttrDropdown"),t.appendChild(document.createElement("option")),t.addEventListener("change",(function(){M()}));for(let e=0,r=z.length;e<r;e++){let r=z[e],n=document.createElement("option");n.value=r,n.textContent=r,t.appendChild(n)}e.appendChild(t)}}if(g){i=x.vals,t.querySelectorAll(".pvtVals select.pvtAttrDropdown").forEach(((t,e)=>{t.value=i[e]})),g=!1}s.aggregatorName=o.value,s.vals=i,s.aggregator=x.aggregators[o.value](i),s.renderer=x.renderers[D.value],s.rowOrder=R.dataset.order,s.colOrder=c.dataset.order,e={},t.querySelectorAll("input.pvtFilter:not(:checked)").forEach((function(t){var r=t.getAttribute("data-filter").split(",");null!=e[r[0]]?e[r[0]].push(r[1]):e[r[0]]=[r[1]]})),r={},t.querySelectorAll("input.pvtFilter:checked").forEach((function(t){var n=t.getAttribute("data-filter").split(",");null!=e[n[0]]&&(null!=r[n[0]]?r[n[0]].push(n[1]):r[n[0]]=[n[1]])})),s.filter=function(t){var r,n,a,l;if(!x.filter(t))return!1;for(n in e)if(r=e[n],a=""+(null!=(l=t[n])?l:"null"),indexOf.call(r,a)>=0)return!1;return!0};let u=t.getElementsByClassName("pvtRendererArea")[0];if(window.pivot(u,E,s),deepMerge({},x,{cols:s.cols,rows:s.rows,colOrder:s.colOrder,rowOrder:s.rowOrder,vals:i,exclusions:e,inclusions:r,inclusionsInfo:r,aggregatorName:o.value,rendererName:D.value}),a={},t.dataset.pivotUIOptions=JSON.stringify(a),x.autoSortUnusedAttrs){e=t.find("td.pvtUnused.pvtAxisContainer");let e=t.querySelector("td.pvtUnused.pvtAxisContainer"),r=Array.from(e.querySelectorAll("li"));r.sort((function(t,e){return naturalSort(t.textContent,e.textContent)})),r.forEach((t=>e.appendChild(t)))}if(G.style.opacity=1,null!=x.onRefresh)return x.onRefresh(a)}}(t),(M=function(){return G.style.opacity=.5,setTimeout(_,10)})(),sortable(t.querySelectorAll(".pvtAxisContainer"),{items:"li",placeholder:"pvtPlaceholder",acceptFrom:".pvtAxisContainer"}).forEach((t=>{t.addEventListener("sortupdate",(function(t){M(),t.detail.origin.container===t.detail.destination.container&&M()}))}))}catch(t){p=t,"undefined"!=typeof console&&null!==console&&console.error(p.stack)}return this};