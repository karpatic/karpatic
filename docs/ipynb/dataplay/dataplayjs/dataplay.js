console.log("start233"),window.labels={},window.setMapping=function(e,i,l,o,n){let s=window.labels[e];s||={},s.mappings||=[],Object.keys(window.labels).forEach((o=>{window.labels[o].mappings=window.labels[o].mappings?.filter((n=>{if(n.vizid===i&&o!==e)return!1;n.vizid!==i||o===e&&(l||=n.viztype)}))})),console.log("setMapping:",{label:e,vizid:i,viztype:l,rows:o,cols:n}),s.mappings.push({label:e,vizid:i,viztype:l,rows:o,cols:n})},window.setMapping=function(e,i,l,o,n){let s=window.labels[e]||{};s.mappings=s.mappings||[];let t={};Object.keys(window.labels).forEach((l=>{window.labels[l].mappings=window.labels[l].mappings.filter((o=>o.vizid!=i||l==e&&(t=o,!1)))}));let a={label:e,vizid:i,viztype:l||(t.viztype||"Table"),rows:!1!==o?o:t.rows||"",cols:!1!==n?n:t.cols||""};s.mappings.push(a),console.log("setMapping:",a)},window.unsetMapping=function(e){console.log("unsetting:",e),Object.keys(window.labels).forEach((i=>window.labels[i].mappings=window.labels[i].mappings?.filter((i=>i.vizid!==e)))),document.getElementById(e)?.remove()},window.setData=function(e,i){console.log("SetData:",e,i),window.labels[e]||={},window.labels[e].data=i},window.setVizType=function(e,i,l,o){console.log("SetVizType:",{vizid:e,viztype:i,rows:l,cols:o}),window.labels?.forEach((n=>{n.mappings.forEach((s=>{s.vizid!==e&&n!=e||(console.log("SetVizType: found mapping",s.vizType,i),!1!==i?s.viztype=i:s.viztype||(s.viztype="Table"),s.rows=!1!==l?l:s.rows??"",s.cols=!1!==o?o:s.cols??"")}))}))},window.update=function({label:e,vizid:i,viztype:l,ds:o,unset:n,rows:s,cols:t}={}){console.log("update: ",{label:e,vizid:i,viztype:l,ds:o,unset:n,rows:s,cols:t}),e?(o&&window.setData(e,o),window.setMapping(e,i||e,l,s,t),window.displayElements(e)):n?window.unsetMapping(i):window.setVizType(i,l,s,t)},window.DELETEdisplayElementsDELETE=function(e){console.log("displayElements: ",{label:e,lblobj:window.labels[e]}),window.labels[e]?.mappings?.forEach((i=>{window.displayElement(window.labels[e].data,i.vizid||e,i.viztype,i.rows,i.cols)}))},window.displayElements=function(e){console.log("displayElements: ",{label:e,lblobj:window.labels[e]});let i=window.labels[e];if(i){let l=i.data,o=i.mappings;o&&o.length>0?o.forEach((i=>{window.displayElement(l,i.vizid||e,i.viztype,i.rows,i.cols)})):window.displayElement(l,e,"Table","","")}},window.displayElement=function(e,i=!1,l="Table",o="",n=""){console.log("displayElement:",{vizid:i,viztype:l,rows:o,cols:n}),i=i||"dataplayVisual"+Math.round(100*Math.random()).toString(),window.callPivot(e,i,o,n,l)},window.callPivot=function(e,i,l,o,n){console.log("callPivot:",{json_data:e,output_id:i,renderName:n,rows:l,cols:o});let s="function"==typeof window.pivotUI,t=document.currentScript.parentElement,fn=()=>{let s=document.getElementById(i);s||(s=document.createElement("div"),s.id=i,t.appendChild(s)),console.log({pivotUtilities:pivotUtilities}),window.pivotUI(s,e,{rows:l,cols:o,rendererName:n,showUI:!0,renderers:Object.assign({},pivotUtilities.renderers)},!0)};s?fn():setTimeout((()=>{fn()}),5e3)};