window.heatmap=function(t,e){var a,n,r,o,l,i,u,s,c,h,p,d;switch(null==t&&(t="heatmap"),s=this.dataset.numrows,u=this.dataset.numcols,null==(a=null!=e&&null!=(c=e.heatmap)?c.colorScaleGenerator:void 0)&&(a=function(t){var e,a;return a=Math.min.apply(Math,t),e=Math.max.apply(Math,t),function(t){var n;return"rgb(255,"+(n=255-Math.round(255*(t-a)/(e-a)))+","+n+")"}}),d=this,n=function(t){var e,n,r;return r=[],(n=function(e){return Array.from(d.querySelectorAll(t)).forEach((function(){var t;if(null!=(t=this.dataset.value)&&isFinite(t))return e(t,this)}))})((function(t){return r.push(t)})),e=a(r),n((function(t,a){return a.style.backgroundColor=e(t)}))},t){case"heatmap":n(".pvtVal");break;case"rowheatmap":for(r=l=0,h=s;0<=h?l<h:l>h;r=0<=h?++l:--l)n(".pvtVal.row"+r);break;case"colheatmap":for(o=i=0,p=u;0<=p?i<p:i>p;o=0<=p?++i:--i)n(".pvtVal.col"+o)}return n(".pvtTotal.rowTotal"),n(".pvtTotal.colTotal"),this},window.barchart=function(t){var e,a,n,r,o,l;for(r=this.dataset.numrows,this.dataset.numcols,l=this,e=function(t){var e,a,n,r,o,i;return i=[],(e=function(e){return Array.from(l.querySelectorAll(t)).forEach((function(){var t;if(null!=(t=this.dataset.value)&&isFinite(t))return e(t,this)}))})((function(t){return i.push(t)})),(a=Math.max.apply(Math,i))<0&&(a=0),r=a,(n=Math.min.apply(Math,i))<0&&(r=a-n),o=function(t){return 100*t/(1.4*r)},e((function(t,e){var a,r,l,i;l=e.textContent,(i=document.createElement("div")).style.position="relative",i.style.height="55px",r="gray",a=0,n<0&&(a=o(-n)),t<0&&(a+=o(t),r="darkred",t=-t);var u=document.createElement("div");u.style.position="absolute",u.style.bottom=a+"%",u.style.left=0,u.style.right=0,u.style.height=o(t)+"%",u.style.backgroundColor=r,i.appendChild(u);var s=document.createElement("div");s.textContent=l,s.style.position="relative",s.style.paddingLeft="5px",s.style.paddingRight="5px",i.appendChild(s),e.style.padding=0,e.style.paddingTop="5px",e.style.textAlign="center",e.innerHTML=i.outerHTML}))},a=n=0,o=r;0<=o?n<o:n>o;a=0<=o?++n:--n)e(".pvtVal.row"+a);return e(".pvtTotal.colTotal"),this};