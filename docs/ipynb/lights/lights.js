function updateColor(){let e=this.value.slice(1),o=parseInt(e.substr(2,2),16),t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(4,2),16);window.myData[this.id.toLowerCase()]=`${o},${t},${n}`,console.log("Got color",this.value,window.myData[this.id.toLowerCase()]),window.bleWrite()}window.charac=!1,window.notificationsActive=!1,window.queued=!1,window.processing=!1,window.myData={lightmode:"swipe",colorone:"255,0,203",colortwo:"255,0,0",colorthree:"0,0,255",animationdelay:100},window.getRandomColor=()=>`${Math.floor(256*Math.random())},${Math.floor(256*Math.random())},${Math.floor(256*Math.random())}`,window.bleWrite=async()=>{if(window.processing)window.queued=!0;else{window.queued=!1,window.processing=!0;const e=(new TextEncoder).encode(JSON.stringify(window.myData));console.log("Ble Write",window.myData,{encoded:e}),await window.charac.writeValue(e).then((()=>{window.processing=!1,window.queued&&window.bleWrite()}))}},window.bleRead=async({target:{value:e}})=>{let o=(new TextDecoder).decode(await e);window.myData=JSON.parse(o),console.log("fromBle: ",window.myData)},window.ble=async()=>{console.log("BLE",window.btDash),window.btDash.style.display="inline-block";const e="4fafc201-1fb5-459e-8fcc-c5c9c3319123";if(window.charac)console.log("Read:",(await window.charac.readValue()).getUint8(0));else{console.log("Setting up!");const o=await navigator.bluetooth.requestDevice({filters:[{name:"Music Strip"}],optionalServices:[e]}),t=await o.gatt.connect().then((o=>o.getPrimaryService(e)));window.charac=await t.getCharacteristic("beb5483e-36e1-4688-b7f5-ea07361b2623"),console.log("Characteristic"),window.notificationsActive||(await window.charac.startNotifications(),window.notificationsActive=!0,window.charac.addEventListener("characteristicvaluechanged",window.bleRead)),document.getElementById("btConnect").insertAdjacentHTML("afterend","<button onclick=\"window.bleWrite('TestEvent')\">TestEvent</button>")}},document.getElementById("colorOne").addEventListener("input",updateColor),document.getElementById("colorTwo").addEventListener("input",updateColor),document.getElementById("colorThree").addEventListener("input",updateColor);