function populatecountryDropdown(e){const t=document.getElementById("countryDropdown");t.innerHTML="",e.forEach((e=>{const n=document.createElement("option");n.value=e.code,n.textContent=e.country,t.appendChild(n)}));const n=t.querySelector('option[value="us"]');n&&(n.selected=!0)}function populateGenreDropdown(e){const t=document.getElementById("genreDropdown");t.innerHTML="",e.forEach((e=>{const n=document.createElement("option");n.value=e.subgenre,n.textContent=e.name,t.appendChild(n)}));const n=t.querySelector('option[value="1004"]');n&&(n.selected=!0)}function debounce(e,t){let n;return function(){const o=this,r=arguments;clearTimeout(n),n=setTimeout((()=>{e.apply(o,r)}),t)}}function filterGenre(){const e=document.getElementById("genreSearch").value.toUpperCase(),t=document.getElementById("genreDropdown").getElementsByTagName("option");for(let n=0;n<t.length;n++){const o=t[n];(o.textContent||o.innerText).toUpperCase().indexOf(e)>-1?o.style.display="":o.style.display="none"}}fetch("/music/assets/apple_countries.json").then((e=>e.json())).then((e=>{populatecountryDropdown(e)})).catch((e=>console.error("Error fetching JSON data:",e))),fetch("/music/assets/apple_genres.json").then((e=>e.json())).then((e=>{populateGenreDropdown(e)})).catch((e=>console.error("Error fetching JSON data:",e)));const debounceFilterGenre=debounce(filterGenre,1e3);function filterLanguage(){const e=document.getElementById("countrySearch").value.toUpperCase(),t=document.getElementById("countryDropdown").getElementsByTagName("option");for(let n=0;n<t.length;n++){const o=t[n];(o.textContent||o.innerText).toUpperCase().indexOf(e)>-1?o.style.display="":o.style.display="none"}}const debounceFilterLanguage=debounce(filterLanguage,1e3);let currentPlaying=null,audioRow=null;function playPreview(e,t){if(!audioRow){audioRow=document.createElement("tr");const e=document.createElement("td");e.colSpan=4,e.innerHTML='<audio id="audioPreview" controls>\n                                   Your browser does not support the audio element.\n                               </audio>',audioRow.appendChild(e)}const n=document.getElementById("audioPreview")||audioRow.querySelector("audio"),o=t.parentNode.parentNode;o.nextSibling!==audioRow&&(audioRow.parentNode&&audioRow.parentNode.removeChild(audioRow),o.parentNode.insertBefore(audioRow,o.nextSibling)),currentPlaying===t?(n.pause(),t.textContent="Preview",t.style.backgroundColor="green",currentPlaying=null):(n.src=e,n.load(),n.play(),t.textContent="Stop",t.style.backgroundColor="red",currentPlaying&&(currentPlaying.textContent="Preview",currentPlaying.style.backgroundColor="green"),currentPlaying=t)}document.getElementById("getAppleData").addEventListener("click",(function(){const e=document.getElementById("genreDropdown").value,t=document.getElementById("countryDropdown").value,n=document.getElementById("explicitCheckbox").checked,o=document.querySelector('input[name="dataType"]:checked').value;fetch(`https://itunes.apple.com/${t}/rss/${o}/limit=100/genre=${e}/explicit=${n?"true":"false"}/json`).then((e=>e.json())).then((e=>{const t=e.feed.entry||[],n=document.getElementById("itunesDataList");n.innerHTML="",t.forEach(((e,t)=>{const o=e["im:name"].label,r=e["im:artist"].label,c=e.link[1].attributes.href,a=document.createElement("tr"),l=`previewButton-${t}`;a.innerHTML=`\n                    <td>${o}</td>\n                    <td>${r}</td>\n                    <td>\n                        <button id="${l}" onclick="playPreview('${c}', this)">Preview</button>\n                    </td>\n                    <td>\n                        <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(r)}+' - '+${encodeURIComponent(o)}" target="_blank">Search YouTube</a>\n                    </td>\n                `,n.appendChild(a)}))})).catch((e=>console.error("Error loading data: ",e)))}));