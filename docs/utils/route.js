window.w=window;export const navEvent=async e=>{console.group("Route: navEvent"),history.pushState({},"",e);let t=e||location.href;(-1==t.indexOf("#")?()=>window.scrollTo({top:0,behavior:"smooth"}):()=>w[t.split("#")[1]]?.scrollIntoView({behavior:"smooth"}))(),t.split("#")[0]!=w.href?.split("#")[0]&&(await handleRoute(),w.href=t),console.groupEnd()};export const handleRoute=async()=>{if(console.group("Route: HandleRoute"),location.pathname.includes("undefined"))return;w.meta||!isLocal&&registerServiceWorker(),w.toast||await import("./refresh_template.js");let e="/"==location.pathname?"index":location.pathname.replaceAll("./","").replaceAll("../","").replace(".html","").replace(/^\//,"").replace(/\/$/,""),t=!isLocal||preRendering?`${location.origin}/posts/${e}.json`:`../../ipynb/${e}.ipynb`,o={};try{o=await(!isLocal||preRendering?await(async()=>(await fetch(t)).json())():(await(async()=>await import("../../../ipynb2web/src/convert.mjs"))()).nb2json(t,!0))}catch(t){try{let t=e.split("/").pop(),a="https://carlos-a-diez.com/cms/notes/"+e.split("/").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join("_"),n=await(await fetch(a)).text();o={meta:{title:t,markdown:"true"},content:(await import("/src/utils/marked.js")).marked(n)}}catch{location.pathname,"#reload"!=location.hash&&(location.hash="reload",location.reload())}}w.oldMeta=w.meta,w.meta=o.meta,meta.content=o.content,console.groupEnd(),w.dispatchEvent(new CustomEvent("load_template"))};const registerServiceWorker=async()=>{if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/utils/service-worker.js");e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"==t.state&&navigator.serviceWorker.controller}}}catch(e){console.error(`Registration failed with ${e}`)}};